{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Astra Editor \u6587\u6863","text":"<p>Astra Editor \u662f\u4e00\u4e2a\u57fa\u4e8e TurboWarp \u5f00\u53d1\u7684 Scratch \u7f16\u8f91\u5668\uff0c\u5b83\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u5b9e\u7528\u529f\u80fd\u548c\u63d2\u4ef6\u3002</p> <p>\u8fd9\u4e9b\u9875\u9762\u662f\u5f00\u6e90\u7684\uff0c\u6b22\u8fce\u505a\u51fa\u66f4\u6539\u3002</p>"},{"location":"blog/","title":"Blog","text":""},{"location":"development/getting-started/","title":"Modding Introduction","text":"<p>These are the instructions for setting up a development environment for TurboWarp itself. This is useful if you want to submit pull requests to us or make your own mod.</p> <p>:::warning Heads up. This page is a bit outdated :(</p> <p>We'll try to get it fixed soon (writing this on Jan 15 2026, did we forget?) :::</p> <p>If you just want to develop custom extensions, see the custom extension documentation instead.</p>"},{"location":"development/getting-started/#dependencies","title":"Dependencies","text":"<p>All of our packages need Git and Node.js v22 (likely anything v18 or later works, but we can't promise that). We assume you are familiar with the command line.</p> <p>Some packages may want some additional things installed, so check the README in each package you want to develop.</p> <p>TurboWarp is a large app that can require multiple gigabytes of disk space and memory to build.</p>"},{"location":"development/getting-started/#organization","title":"A note on how Scratch is organized","text":"<p>Scratch is broken up into a bunch of different packages, each implementing one part of the app.</p> <ul> <li>scratch-gui implements much of the interface (eg. the sprite list), connects everything together, and is where addons live</li> <li>scratch-vm runs projects. It's where the compiler lives.</li> <li>scratch-render is what displays things like the stage, sprites, text bubbles, and pen. It also implements blocks like \"touching\". Note that things that are rendered on top of sprites such as variable monitors are actually part of scratch-gui.</li> <li>scratch-svg-renderer helps fix various SVG rendering problems (we rename this to @turbowarp/scratch-svg-renderer)</li> <li>scratch-render-fonts contains all the fonts that SVG costumes can use</li> <li>scratch-paint is the costume editor</li> <li>scratch-parser extracts and validates sb2 and sb3 files</li> <li>scratch-storage is an abstraction around fetch() used for downloading (and theoretically uploading) files (we rename this to @turbowarp/scratch-storage)</li> <li>scratch-l10n contains some translations (we rename this to @turbowarp/scratch-l10n)</li> </ul> <p>In addition, the desktop app and packager are also support repositories.</p>"},{"location":"development/getting-started/#gui","title":"Building the GUI","text":"<p>If you want to mod Scratch, you'll need to be able to build the GUI. This is a common pattern you'll use for developing on Scratch packages:</p> <pre><code># clone it\ngit clone https://github.com/TurboWarp/scratch-gui\ncd scratch-gui\n\n# install dependencies (preferred over `npm install` as it is faster and won't modify package-lock.json)\nnpm ci\n\n# start development playground\nnpm start\n</code></pre> <p>This starts the live development server for most packages, if there is one. For example, for scratch-gui, the playground can be accessed at http://localhost:8601/. See the README or the output of <code>npm start</code> for information for other packages.</p>"},{"location":"development/getting-started/#build","title":"Build","text":"<p>While <code>npm start</code> is useful for development, at some point you'll need to get raw files out. You can do this with:</p> <pre><code>npm run build\n</code></pre> <p>The output will be in the <code>build</code> folder.</p> <p>When deploying TurboWarp to a live website, you should enable production mode. This will result in faster execution and a greatly reduced file size:</p> <pre><code># mac, linux\nNODE_ENV=production npm run build\n\n# windows command prompt (untested)\nset NODE_ENV=production\nnpm run build\n\n# windows powershell\n$env:NODE_ENV=\"production\"\nnpm run build\n</code></pre> <p>By default TurboWarp generates links like <code>https://turbowarp.org/editor.html#123</code>. However, by setting the variables <code>ROOT=/</code> and <code>ROUTING_STYLE=wildcard</code> (in the same way that you set <code>NODE_ENV=production</code>), you can get routes like <code>https://turbowarp.org/123/editor</code> instead. Note that this requires a server that will setup the proper aliases. The webpack development server in scratch-gui is setup for this. For production you'd want something more like https://github.com/TurboWarp/turbowarp.org.</p>"},{"location":"development/getting-started/#linking","title":"Linking other packages","text":"<p>Linking packages lets you run use your local versions of packages in your other local packages. So you can use your local scratch-vm inside your local scratch-gui. That lets you actually see what your scratch-vm changes do in a real GUI.</p> <p>We used to recommend using <code>npm link</code> to do this. Unfortunately, npm is an awful piece of software that gets worse every update. This command used to work perfectly, but they broke it because of course. It's now better to manually create symlinks yourself in node_modules. (We are amazed how they were able to take a perfectly functional command and make it slow and break if you go more than one level deep)</p> <p>We need to update this section still to reflect the new recommendations. In the mean time <code>npm link</code> does somewhat still work if you only need to go one level deep and are okay with waiting a long time for what should be a single system call.</p> <p>To develop packages other than scratch-gui, you need to tell npm to use local copies of the package instead of the ones it downloaded from the internet. This is called linking. The pattern is:</p> <pre><code># clone the package you want to develop in the same folder as scratch-gui\n# (folder doesn't really matter but it makes things easier to keep track of)\ncd scratch-gui/..\ngit clone https://github.com/TurboWarp/scratch-vm\n\n# install dependencies in the child package\ncd scratch-vm\nnpm ci\n\n# tell npm that this is your local copy of the package\nnpm link\n\n# for some packages (eg. storage, svg-renderer), you may need to build for your changes to apply\nnpm run build\n\n# tell scratch-gui to use your local copy of the package\ncd ../scratch-gui\nnpm link scratch-vm\n</code></pre>"},{"location":"development/globals/","title":"Globals","text":"<p>Global variables that can be accessed using the developer console, for convenience.</p> <p>These can not be used in sandboxed custom extensions and should not be used in unsandboxed custom extensions.</p>"},{"location":"development/globals/#vm","title":"<code>vm</code>","text":"<p>Refers to the scratch-vm instance.</p>"},{"location":"development/globals/#scratchblocks","title":"<code>ScratchBlocks</code>","text":"<p>Refers to the real scratch-blocks (<code>Blockly</code> has very little stuff on it). Only available after opening the editor.</p>"},{"location":"development/globals/#paper","title":"<code>paper</code>","text":"<p>Refers to the paper.js instance. Only available after opening the costume editor.</p>"},{"location":"development/globals/#reduxstore","title":"<code>ReduxStore</code>","text":"<p>Refers to the internal redux store used by scratch-gui.</p> <p>Get state with <code>ReduxStore.getState()</code> and dispatch events with <code>ReduxStore.dispatch({ type: \"...\" })</code></p>"},{"location":"development/home/","title":"Development","text":"<p>If you want to build TurboWarp itself (scratch-gui, scratch-vm, etc.), see Modding Introduction.</p> <p>If you want to build custom extensions, see Custom Extensions</p>"},{"location":"development/scratchx/","title":"ScratchX &amp; TurboWarp","text":"<p>TurboWarp has primitive support for using ScratchX extensions and loading ScratchX projects (.sbx). ScratchX was a modified version of Scratch 2 created by the Scratch Team that allowed using unofficial extensions. ScratchX no longer functions due to Flash being removed from all major browsers, and the website was finally shut down in early 2023.</p> <p>ScratchX extensions run in the extension sandbox. Any functionality related to hardware will not work. Many extensions also rely on web services that are increasingly broken due to the age of the extensions.</p> <p>To use a ScratchX extension in TurboWarp, find the URL to the extension's JavaScript source code and load it as you would any other custom extension.</p>"},{"location":"development/extensions/assorted-apis/","title":"Assorted APIs","text":"<p>import {ExtensionCode} from './utils.js';</p> <p>Now that you are familiar with writing custom extensions, we will share some more APIs. These APIs are available in both sandboxed and unsandboxed extensions. They can all be used together.</p>"},{"location":"development/extensions/assorted-apis/#color1-color2-color3","title":"color1, color2, color3","text":"<p>These three properties determine, respectively, the color of the blocks, the color of the block inputs, and the color of the block menus of each extension. The general advice is that <code>color1</code> should be the brightest, <code>color2</code> slightly darker, and <code>color3</code> the darkest. They should be set to hex color codes.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/color.js\")}</p> <p>Different block color modes (such as High Contrast, Dark and any \"Addons\" presets) are automatically generated based on these values.</p>"},{"location":"development/extensions/assorted-apis/#docsuri","title":"docsURI","text":"<p>docsURI adds a button at the start of the block list that opens a page for people to learn more about how your extension works.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/hello-docs.js\")}</p>"},{"location":"development/extensions/assorted-apis/#disablemonitor","title":"disableMonitor","text":"<p>Scratch will automatically show a checkbox to show a variable monitor by REPORTER blocks with no inputs. Note that in TurboWarp, this applies to BOOLEAN blocks too. To disable this, set disableMonitor to true on the block.</p> <p>Note that, even if disableMonitor is set, it is still possible for someone to manually create a monitor using a modified (or old) version of the extension or other tools.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unmonitorable.js\")}</p>"},{"location":"development/extensions/assorted-apis/#scratchcast","title":"Scratch.Cast","text":"<p>The way that Scratch handles operations such as type conversions or comparisons has numerous quirks. Instead of trying to write them yourself, you can use the Scratch.Cast.* APIs.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/cast.js\")}</p>"},{"location":"development/extensions/assorted-apis/#hidefrompalette","title":"hideFromPalette","text":"<p>Sometimes you might want to hide a block from the flyout, but you don't want to remove it. This is useful to make sure that your changes are backward compatible. Blocks with the property hideFromPalette will be hidden from the flyout, but any copies of them that are already in the project will continue to work the same.</p> <p>For example, load the first extension here, and save a project using its block:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/hidden-1.js\")}</p> <p>Then load this extension instead, and load the project from before:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/hidden-2.js\")}</p> <p>See that the copies of the block that already exist continue to work, but it is not listed in the toolbox.</p>"},{"location":"development/extensions/assorted-apis/#filter","title":"filter","text":"<p>Some of your blocks may only work in sprites or only work in the stage. For these blocks, you can use the filter property to an array containing either <code>Scratch.TargetType.STAGE</code> or <code>Scratch.TargetType.SPRITE</code> to make it only visible in that type of target.</p> <p>Note that it is still possible to get blocks that violate the filter property by, for example, using drag and drop or the backpack. Thus, your blocks must still check if the target is a stage or sprite with <code>util.target.isStage</code>.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/filter.js\")}</p>"},{"location":"development/extensions/assorted-apis/#icons","title":"Icons","text":"<p>There are three different ways to add images to your extension:</p> <ul> <li>menuIconURI for the whole extension. This sets the image that appears in the block palette. If not set, defaults to blockIconURI. If that's also not set, defaults to a circle of the extension's color.</li> <li>blockIconURI for the whole extension. This will be the default for all blocks that don't override it.</li> <li>blockIconURI for each block. This overrides the blockIconURI set on the entire extension.</li> </ul> <p>Each of these properties should be inline data: URLs. SVG is preferred, but PNG or JPG at least 64x64 in size also works well. Icons should be square.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/icons.js\")}</p>"},{"location":"development/extensions/assorted-apis/#inline-images","title":"Inline images","text":"<p>You can also put images anywhere in a block using an \"argument\" of type IMAGE and setting <code>dataURI</code> on the argument. Like the other images, this is a data: URL. SVG is preferred, but PNG or JPG at least 64x64 in size also works well. Icons should be square.</p> <p>Additionally, if you set <code>flipRTL</code> to true, the image will be horizontally flipped in right-to-left languages.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/inline-images.js\")}</p>"},{"location":"development/extensions/assorted-apis/#separators","title":"Separators","text":"<p>If your extension has a lot of blocks you may want to put some space between groups of blocks. To do this, include <code>\"---\"</code> in the blocks list:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/separators.js\")}</p>"},{"location":"development/extensions/assorted-apis/#terminal-blocks","title":"Terminal blocks","text":"<p>To prevent connecting a block underneath a COMMAND block, set <code>isTerminal: true</code> on the block.</p> <p>While the block's shape will look similar to \"stop this script\" and \"stop all\", the behavior matches neither. If this block is placed at the end of a loop for example, the loop will continue to run unless additional code stops the current thread. This just prevents connecting a block underneath.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/terminal.js\")}</p>"},{"location":"development/extensions/assorted-apis/#next-steps","title":"Next steps","text":"<p>Next, let's see how to make blocks like \"when I receive\" or \"when timer greater than\".</p>"},{"location":"development/extensions/async/","title":"Dealing with things that aren't instant","text":"<p>import {ExtensionCode} from './utils.js';</p> <p>Sometimes you will want your extension to wait for an \"asynchronous\" or \"async\" operation to complete before resuming execution (versus resuming execution early and potentially causing problems). A common example of this is making a request: no matter how fast your internet is, any network request is not going to be instant.</p> <p>Modern JavaScript has a cool utility for dealing with these: Promises. These are how your block can inform Scratch that your block is waiting for an async operation to complete, and the eventual value.</p> <p>{require('!raw-loader!@site/static/example-extensions/async.js')}</p> <p>Notice the async blocks are defined the same as other blocks in getInfo(). The only difference is the return value of the function.</p> <p>The first block in this question is roughly equivalent to Scratch's built-in wait block. Notice that we had to manually construct a Promise this time because setTimeout does not use Promises. When Scratch hits this block, it won't continue executing the script until this promise resolves. Scratch may continue executing other scripts in the meantime. Wait is a command block (no return value), so it shouldn't resolve with anything (it would be ignored).</p> <p>The second block is a block that tries to fetch a URL, similar to the \"Fetch\" extension on https://extensions.turbowarp.org/. fetch() already returns a promise, so we simply chain on top of it instead of making a new promise this time.</p> <p>The restriction on return values still applies: you still need to ensure that you return a string, number, or boolean, so we call text() in then() to convert the Response object from fetch() into a string.</p> <p>This also demonstrates error handling. Whenever your promises can reject, fail, or error, you should add a catch(). How exactly you handle this will depend on your use case, but often you will want to log the error to the console and return a string indicating the error.</p>"},{"location":"development/extensions/async/#exercises","title":"Exercises","text":"<ol> <li>Create a block that waits 100ms for each time it's been called. For example, the first time it's run it waits 100ms, then 200ms, then 300ms, then 400ms, etc.</li> </ol>"},{"location":"development/extensions/async/#next-steps","title":"Next steps","text":"<p>You may have realized that even your blocks that don't return a Promise don't actually run instantly and your extension can't access many APIs. To determine why, we need to discuss what the \"sandbox\" really is, and what it means for your extensions.</p>"},{"location":"development/extensions/better-development-server/","title":"A better development server","text":"<p>import {Spoiler} from './utils.js';</p> <p>The HTTP server built into Python is simple to use, but it's primitive. We can do better. This section is strictly optional, but we think it will make your life easier.</p>"},{"location":"development/extensions/better-development-server/#turbowarpextensions","title":"TurboWarp/extensions","text":"<p>The GitHub repository of extensions.turbowarp.org is TurboWarp/extensions. One of the things available here is the development server that we use, along with the code that makes the website. You can run it locally too.</p> <p>This will require Git and Node.js to be installed locally. Run these commands to download the server and install its dependencies:</p> <pre><code>git clone https://github.com/TurboWarp/extensions.git\ncd extensions\nnpm ci\n</code></pre> <p>Now open up your code editor to the \"extensions\" repository you just downloaded.</p> <p>Close your old development server and start the new one with:</p> <pre><code>npm run dev\n</code></pre> <p>Now navigate to http://localhost:8000 -- you should see a list similar to extensions.turbowarp.org. For now, we're not going to worry about the list, we're just going to use the development server part.</p> <p>The place to save your extension JS is in the <code>extensions</code> folder inside of the repository. If you intend to submit these to us later, you should create a user folder for your extensions. For example, if your username is <code>TestMuffin</code>, you might save your fetching extension in the folder <code>extensions/TestMuffin/fetch.js</code> and load it using http://localhost:8000/TestMuffin/fetch.js. The extension should then also use an ID that contains your username, such as <code>testmuffinfetch</code>.</p> <p>The local development server is set up with the correct headers so that you don't need to manually hard refresh to ensure your script changes apply, and it tries to mimic the real extensions.turbowarp.org website as much as possible. It also includes TypeScript hints for many common Scratch APIs and ESLint rules for common mistakes.</p> <p>In the future, we may consider adding more development features.</p>"},{"location":"development/extensions/better-development-server/#exercises","title":"Exercises","text":"<ol> <li>Can you figure out how to add a new HTML file to the development server? (Hint: look into the \"website\" folder)</li> <li>Can you figure out how to add your extension to the homepage list? (Hint: look at \"extensions/extensions.json\")</li> <li>Can you figure out how to add an image for your extension on the homepage? (Hint: create an image in \"images\" with the same folder and basename as the file in \"extensions\")</li> </ol>"},{"location":"development/extensions/better-development-server/#next-steps","title":"Next steps","text":"<p>Next, let's use our improved development experience to learn about more of the APIs and options available to extensions.</p>"},{"location":"development/extensions/compatibility/","title":"Maintaining compatibility","text":"<p>Once projects exist using your extension, it is critical that you do not change the extension in ways that will break compatibility as doing so will effectively corrupt projects.</p>"},{"location":"development/extensions/compatibility/#what-you-must-never-change","title":"What you must never change","text":""},{"location":"development/extensions/compatibility/#the-extension-id-must-never-change","title":"The extension ID must never change","text":"<pre><code>  getInfo() {\n    return {\n      // highlight-start\n      // THIS MUST NEVER CHANGE\n      id: 'fetch'\n      // highlight-end\n      // ...\n    };\n  }\n</code></pre>"},{"location":"development/extensions/compatibility/#block-opcodes-and-types-must-never-change","title":"Block opcodes and types must never change","text":"<p>Instead, create a new block and mark the old one as <code>hideFromPalette: true</code>.</p> <p>It is generally safe to change blockType from REPORTER to BOOLEAN or from HAT to EVENT, but a conversion of HAT to BOOLEAN would be problematic.</p> <pre><code>  getInfo() {\n    return {\n      // ...\n      blocks: [\n        {\n          // highlight-start\n          // THESE MUST NEVER CHANGE\n          blockType: Scratch.BlockType.REPORTER,\n          opcode: \"fetch\",\n          // highlight-end\n          // ...\n        }\n      ]\n    };\n  }\n</code></pre>"},{"location":"development/extensions/compatibility/#blocks-must-never-be-removed","title":"Blocks must never be removed","text":"<p>Instead, create a new block and mark the old one as <code>hideFromPalette: true</code>.</p> <pre><code>  getInfo() {\n    return {\n      // ...\n      blocks: [\n        // highlight-start\n        // THIS MUST NEVER BE DELETED\n        {\n          opcode: \"old\",\n          hideFromPalette: true\n          // highlight-end\n          // ...\n        }\n      ]\n    };\n  }\n</code></pre>"},{"location":"development/extensions/compatibility/#argument-ids-and-types-must-never-change-or-be-removed","title":"Argument IDs and types must never change or be removed","text":"<pre><code>  getInfo() {\n    return {\n      // ...\n      blocks: [\n        {\n          // highlight-start\n          // THE ARGUMENT ID \"INPUT\" MUST NEVER BE CHANGED OR REMOVED\n          text: \"block [INPUT]\",\n          arguments: {\n            INPUT: {\n              type: Scratch.ArgumentType.REPORTER,\n              // highlight-end\n              // ...\n            }\n          },\n          // ...\n        }\n      ]\n    };\n  }\n</code></pre>"},{"location":"development/extensions/compatibility/#arguments-must-never-be-added-to-existing-blocks","title":"Arguments must never be added to existing blocks","text":"<p>Instead, create a new block and mark the old one as <code>hideFromPalette: true</code>. The new block can be reimplemented in terms of the old one:</p> <pre><code>  getInfo() {\n    return {\n      // ...\n      blocks: [\n        {\n          blockType: Scratch.BlockType.REPORTER,\n          id: \"oldBlock\",\n          text: \"old [INPUT1]\",\n          arguments: {\n            INPUT1: { /* ... */ }\n          },\n          hideFromPalette: true\n        },\n        {\n          blockType: Scratch.BlockType.REPORTER,\n          opcode: \"newBlock\",\n          text: \"new [INPUT1] [INPUT2]\",\n          arguments: {\n            INPUT1: { /* ... */ },\n            INPUT2: { /* ... */ }\n          }\n        }\n      ]\n    };\n  }\n  oldBlock(args) {\n    return this.newBlock({\n      ...args,\n      INPUT2: \"Default value\"\n    });\n  }\n  newBlock(args) {\n    // ...\n  }\n</code></pre>"},{"location":"development/extensions/compatibility/#dont-modify-isterminal","title":"Don't modify isTerminal","text":"<p>If a COMMAND block does not already have <code>isTerminal: true</code>, then don't add it as doing so will cause existing projects that connect blocks underneath to break. Instead, create a new block and optionally hide the old one.</p>"},{"location":"development/extensions/compatibility/#dont-modify-acceptreporters","title":"Don't modify acceptReporters","text":"<p>Converting an input menu to a field menu and vice-versa does not work and will corrupt projects. Create a new menu and block instead.</p>"},{"location":"development/extensions/compatibility/#dont-significantly-change-block-behavior","title":"Don't significantly change block behavior","text":"<p>Trivial bug fixes are typically fine, but significant changes may break projects. This is a bit harder to quantify; the best way to make sure your changes don't break projects is extensive testing.</p>"},{"location":"development/extensions/compatibility/#what-you-can-change","title":"What you can change","text":"<p>You can always change these parts of extension metadata:</p> <ul> <li>name</li> <li>docsURI</li> <li>color1, color2, color3</li> <li>menuIconURI and blockIconURI</li> </ul> <p>You can always change these parts of blocks and arguments:</p> <ul> <li>text, as long as it contains the same arguments (changing argument order is safe)</li> <li>disableMonitor (enabling true just hides checkmark, does not remove existing monitors)</li> <li>hideFromPalette</li> <li>filter (adding filter just hides from palette, does not remove existing blocks)</li> <li>defaultValue</li> <li>dataURI and flipRTL in image inputs</li> </ul> <p>For menus, you can always change <code>text</code>, but you should not change <code>value</code> without careful consideration. Adding menu items is always okay, but removing menu items is dangerous.</p>"},{"location":"development/extensions/compatibility/#what-if-you-need-to-break-compatibility","title":"What if you need to break compatibility?","text":"<p>There are times when there is no option but to break backward compatibility. In these instances, you should create a brand new extension with an entirely new ID and leave the old version untouched.</p> <p>For example, if your extension <code>fetch</code> needs a complete redesign, you could create a new extension with the ID <code>fetch2</code>.</p>"},{"location":"development/extensions/compatibility/#next-steps","title":"Next steps","text":"<p>Next, let's learn how to share your extension with the world.</p>"},{"location":"development/extensions/docsURI-demo/","title":"Example docsURI page","text":"<p>The extension that demonstrates how to use docsURI points to this page.</p> <p>In a real docsURI page, you might explain a bit about how the extension works, what the blocks do, and other things like that.</p>"},{"location":"development/extensions/hats/","title":"Events and hats","text":"<p>import {ExtensionCode, Spoiler} from './utils.js';</p> <p>Event blocks and hat blocks are two types of blocks that allow you to control when a script runs. Even though they look similar, they are different.</p>"},{"location":"development/extensions/hats/#event-blocks","title":"Event blocks","text":"<p>Event blocks are for running scripts in response to an external event. An example of this is \"when flag clicked\" - the event is when the user clicks on the flag button. \"when this sprite clicked\" similarly is run in response to a click event, though Scratch does a bit more work to figure out which sprite the event happened on. Event blocks can be used for any external event that lets you run a callback.</p> <p>:::warning Event blocks are only supported in unsandboxed extensions. :::</p> <p>Event blocks never get executed; they just mark which scripts to run. For example, consider this block you're familiar with:</p> <p></p> <p>When you run this block, it doesn't do anything on its own. It just indicates that the things under it should be run. We can create our own event block with similar functionality using <code>Scratch.BlockType.EVENT</code>:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/when-space-key-pressed.js\")}</p> <p>We'll talk about what <code>isEdgeActivated: false</code> means later, but for event blocks this is required boilerplate.</p> <p>In this example we define the opcode <code>whenSpacePressed</code>, but because it is an event block, we don't write any code for it.</p> <p>To start an event block, you use startHats. There are two versions of this:</p> <ul> <li><code>Scratch.vm.runtime.startHats</code> which should be used outside of a block  (for example, clicking the green flag)</li> <li><code>util.startHats</code> which should be used when inside of a block (for example, the broadcast block)</li> </ul> <p>:::warning Using <code>Scratch.vm.runtime.startHats</code> instead of <code>util.startHats</code> inside of a block can break script execution. :::</p> <p>The arguments and return values are the exact same. The first argument passed to startHats is the full block opcode, which is <code>extensionid_opcode</code>. In this example that is <code>eventexampleunsandboxed_whenSpacePressed</code>. This will start running all of the scripts in the project whose top block is this opcode.</p> <p>In this example we used the keydown event, but you can use anything you want. Try using a click event instead, or a setTimeout/setInterval, fetch(), and other APIs. As long as you get a callback, this will work.</p>"},{"location":"development/extensions/hats/#filtering-by-menu","title":"Filtering by menu","text":"<p>You may notice that Scratch's builtin \"when key pressed\" block has a menu. With our current extension, we would need to add a new block for every key. That's not ideal. Instead, we too can use a menu.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/when-key-pressed.js\")}</p> <p>The block is defined similar to every other block. Note that event blocks only support field menus. You can't have text inputs or anywhere for someone to drop a block. To filter by an argument, it must be a menu with acceptReporters: false. (Block types discussed later are more relaxed about this.)</p> <p>The first argument to startHats is again the full opcode. The second argument to startHats is an object that is used to filter which events to activate. The name of the keys in this object are the names of the block's arguments (<code>KEY</code>, in this example) and the values correspond to the menu's values (not text!). You can filter by multiple keys if you want, and all will have to match.</p> <p>The real \"when key pressed\" block in Scratch is a bit more complicated than this. This is just an example.</p>"},{"location":"development/extensions/hats/#filtering-by-sprite","title":"Filtering by sprite","text":"<p>Scratch's \"when this sprite clicked\" block only runs on one sprite, not every sprite. To do this yourself, you can use the third (and final) argument of startHats. The third argument can be set to a target object -- every sprite or clone is a \"target\". If set, only the event blocks in that target will run.</p> <p>The most common ways to get target objects are:</p> <ul> <li><code>Scratch.vm.runtime.getTargetForStage()</code> to get the stage target</li> <li><code>Scratch.vm.runtime.getSpriteTargetByName(\"Sprite1\")</code> to get the non-clone target with a given name</li> <li><code>Scratch.vm.runtime.targets</code> for the full list to search on your own</li> </ul> <p>In this example, we've modified the previous extension to only run the block if they're in the stage.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/when-key-pressed-stage.js\")}</p> <p>To filter by only sprite and not fields, you can set the second argument to null or an empty object (<code>{}</code>).</p>"},{"location":"development/extensions/hats/#restarting-existing-threads","title":"Restarting existing threads","text":"<p>Consider this script:</p> <p></p> <p>You may observe that if you repeatedly press space, the script doesn't restart (which would reset the wait block timer) -- it just keeps executing. If this isn't what you want, set <code>shouldRestartExistingThreads: true</code> on the block.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/when-key-pressed-restart.js\")}</p> <p>If you recreate the same script, as long as you repeatedly press space, the say block will never execute as the script is restarted each time which resets the wait block timer.</p> <p>Note that if a script whose top block has <code>shouldRestartExistingThreads: true</code> runs calls startHats on itself (similar to \"when I receive message1: broadcast message1\"), the currently running script will be marked to be restarted but continue to run blocks until it yields.</p>"},{"location":"development/extensions/hats/#started-thread-list","title":"Started thread list","text":"<p>Finally, startHats returns an array of the Thread objects that it started. You could use this to monitor thread status, determine how many threads were started, etc.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/broadcast-5.js\")}</p>"},{"location":"development/extensions/hats/#predicate-based-hat-blocks","title":"Predicate-based hat blocks","text":"<p>:::info Predicate-based hats are only supported in unsandboxed extensions. :::</p> <p>Predicate-based hat blocks let you create something similar to:</p> <p></p> <p>A predicate-based hat is basically a more powerful version of event blocks. It uses the same startHats and supports <code>shouldRestartExistingThreads</code>. In addition to that, hat block must define a function that returns true or false. All of the block's inputs will be evaluated, and then the hat block can use that information to determine whether or not the blocks under it should run. The block type is <code>Scratch.BlockType.HAT</code>. We can approximate the above as something like:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/when.js\")}</p> <p>You can test the block like this:</p> <p></p> <p>Note that this is not quite the same. The forever block will run many, many times per frame if there are no visual changes or if the project is in turbo mode, while the hat block will run exactly once per frame.</p> <p><code>isEdgeActivated: false</code> is again required boilerplate. The block is defined the same as any other. startHats works the exact same as it does for event blocks: the first argument is the full opcode, then optional field filters, then optional target filter.</p> <p>The important difference is that <code>when</code> actually has code. After you do startHats, the block's inputs and arguments will be evaluated and passed to the block. The block can either return <code>true</code> to let the script run or <code>false</code> to prevent it from running. The block can also return a Promise that resolves to either <code>true</code> or <code>false</code> if necessary.</p> <p>One tricky thing here is that Scratch won't automatically start predicate-based hat blocks -- you need to do so yourself. In this example we use the <code>BEFORE_EXECUTE</code> event (It runs, as the name implies, before any scripts get run, so anything you start here will be run during that frame). As with event blocks, you can run your predicate-based hat blocks from anywhere that you get a callback.</p>"},{"location":"development/extensions/hats/#edge-activated-hat-blocks","title":"Edge-activated hat blocks","text":"<p>Predicate-based hats let you run a script when a condition is true. Edge-activated hat blocks let you run a script when a condition becomes true.</p> <p>This is a subtle but important difference. Consider these two scripts:</p> <p></p> <p>While the blocks may look similar, they have a significant difference. The top one will only run once when the timer becomes 5 while the bottom one will run repeatedly after the timer reaches 5.</p> <p>:::info Edge-activated hats can be used in any extension, even sandboxed ones :::</p> <p>Let's think about how you would implement this using normal Scratch blocks. You could try something like this:</p> <p></p> <p>This will only work once. How could we make it work infinitely many times?</p> <p></p> <p>Almost. Edge activated hats wait for the condition to become false before the script can run again -- a condition can't become true if it is already true.</p> <p></p> <p>In essence, edge-activated hats let us rewrite that loop as:</p> <p></p> <p>To demonstrate this, we can write an extension similar to Scratch's \"when timer greater than\" block. The blockType is again <code>Scratch.BlockType.HAT</code>, but this time with <code>isEdgeActivated: true</code>:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/timer-reimplementation.js\")}</p> <p>Notice that we don't have to run startHats -- Scratch automatically runs startHats for each edge activated hat at the beginning of a frame. This lets you use edge activated hats in sandboxed extensions. You also should not use <code>shouldRestartExistingThreads: true</code> for edge-activated hats.</p> <p>To test this use a script like this:</p> <p></p> <p>Open up the JavaScript console, press the green flag, then wait a few seconds. You'll see something like this:</p> <pre><code>...\n2.719 false\n2.753 false\n2.785 false\n2.818 false\n2.851 false\n2.885 false\n2.918 false\n2.951 false\n2.985 false\n3.017 true\n4.113 true\n4.148 true\n4.181 true\n4.214 true\n4.248 true\n4.281 true\n4.314 true\n4.347 true\n4.381 true\n...\n</code></pre> <p>The moment the extension's timer reached 3 seconds, the block returned true, and the script began running. The logs stop for 1 second because the script was running. Once the script finished, the hat block started running again. As it is still returning true, the script will not run again as the condition did not become true.</p> <p>Similar to predicate-based hats, edge-activated hats can accept arbitrary inputs and return a Promise if necessary.</p>"},{"location":"development/extensions/hats/#exercises","title":"Exercises","text":"<ol> <li>Create an event-based block that runs once every second, another one every 5th second, and another every 10th second.</li> <li>Combine each of those event blocks into one block with a menu.</li> <li>Create a command block with a text input that will run a normal Scratch broadcast. The built-in \"when I receive\" block has the full opcode <code>event_whenbroadcastreceived</code> and its single argument is called <code>BROADCAST_OPTION</code> which is the name of the broadcast.</li> <li>Modify the previous exercise's broadcast block to be a reporter that returns a comma-separated list containing the name of each sprite that a new thread was started in. (Hint: Each thread object contains a .target property, and each target object has a .getName() method.)</li> </ol>"},{"location":"development/extensions/hats/#next-steps","title":"Next steps","text":"<p>We've covered a lot of APIs, but how do we make sure that the changes we make won't break projects?</p>"},{"location":"development/extensions/hello-world/","title":"Hello, world!","text":"<p>import {ExtensionCode} from './utils.js';</p> <p>Let's start by creating a very simple extension. This extension just adds a block that reports \"Hello, world!\":</p> <p>{require('!raw-loader!@site/static/example-extensions/hello-world.js')}</p> <p>The above is a standard component we will use for showing extension code. Make note of the \"Try this extension\" button by the title -- that link will let you see what this extension does without having to do anything locally. Note that these extensions are primarily for demonstrating API features; they are not intended to be actually used in projects. There will almost always be another extension on extensions.turbowarp.org that does the same thing, but better.</p> <p>If you're just using simple files to develop extensions, save this code into a file called \"hello-world.js\". If you're using a local HTTP server, save the code in a file called \"hello-world.js\" that the server will let you access.</p> <p>Now, go to the TurboWarp editor, click on the add extension button (a + next to 2 blocks), scroll to the bottom of the Scratch section, and choose the \"Custom Extension\" option. Either enter the full URL to your local HTTP server or use one of the other tabs to select your file or paste in code. For now, do not check the \"Run extension without sandbox\" box.</p> <p>After a second, an extension named \"It works!\" should appear in the sidebar. If it doesn't appear, open up your developer tools and look for any warnings in the console. Some of the most common errors are:</p> <ul> <li>Syntax error in the JavaScript. This should appear in your browser's developer tools.</li> <li>Runtime error in the JavaScript. This should appear in your browser's developer tools.</li> <li>Your ad blocker or browser is blocking requests to localhost. Try turning off your ad blocker. Once your extension is published on an internet-facing website this shouldn't be a problem.</li> </ul> <p>Now, we will dissect what is going on in this file in the order it runs.</p>"},{"location":"development/extensions/hello-world/#constructing-and-registering","title":"Constructing and registering","text":"<pre><code>class MyExtension {\n</code></pre> <p>This is a standard JavaScript class. It is conventional to define your extension in the form of a class. The name of the class doesn't matter, but we suggest making it somehow based on the extension's name. It doesn't have to be unique at this stage.</p> <pre><code>Scratch.extensions.register(new HelloWorld());\n</code></pre> <p>This constructs your class into an object and introduces the special API that allows extensions to function: <code>Scratch</code>. There's a lot on <code>Scratch</code>, but one of the most important functions is <code>Scratch.extensions.register</code>.</p> <p>Make sure to always call register() exactly once. If you don't call it, your extension will never get added and we will keep waiting for it to load. If you call it multiple times, the behavior is undefined, so don't rely on it.</p>"},{"location":"development/extensions/hello-world/#getinfo","title":"getInfo()","text":"<pre><code>  getInfo() {\n    return {\n      id: 'helloworld',\n      name: 'It works!',\n      blocks: [\n        {\n          opcode: 'hello',\n          blockType: Scratch.BlockType.REPORTER,\n          text: 'Hello, world!'\n        }\n      ]\n    };\n  }\n</code></pre> <p>When you call register(), Scratch will then call the getInfo() function on the provided object. This object must return an object with metadata about the extension. Some of the fields are <code>id</code>, <code>name</code>, and <code>blocks</code>. Here's a short summary of those:</p> Type Description id string A unique ID used only by this extension. Multiple extensions cannot share the same ID. Can only use the letters a-z and 0-9 -- no spaces or special characters. name string The name of the extension that appears in the toolbox. If not provided, it will default to the extension id. blocks array A list of objects that describe the blocks in the project. <p>Here's a short summary of what each block should have:</p> Type Description opcode string The name of the function that should run when this block runs. For example, if this is \"hello\", then the class's \"hello\" method will be run. Each opcode must be unique within each extension, so multiple extensions can each have a block with opcode \"hello\". blockType Scratch.BlockType.* Determines the block's shape. Most commonly Scratch.BlockType.COMMAND, Scratch.BlockType.REPORTER, or Scratch.BlockType.BOOLEAN. See the table below for details. text string The text that will appear in the editor for the block. There is a bit of special syntax here for dealing with arguments that will be discussed in the next segment. arguments object Optional. Discussed in the next section. <p>These are the acceptable values for blockType:</p> Description Example Scratch.BlockType.COMMAND A block that doesn't report a value move 10 steps Scratch.BlockType.REPORTER A round block that reports a string or number x position, costume name Scratch.BlockType.BOOLEAN A block with pointy edges that reports a boolean (true or false) mouse down Scratch.BlockType.HAT A block that starts in response to specific conditions. Discussed later. when loudness &gt; 10 Scratch.BlockType.EVENT A block that starts in response exclusively to events. Discussed later. when this sprite clicked <p>While other BlockTypes do exist, they do not work well and will not be discussed at this time.</p>"},{"location":"development/extensions/hello-world/#the-blocks","title":"The blocks","text":"<pre><code>  hello() {\n    return 'Hello, world!';\n  }\n</code></pre> <p>This defines the function that will run the block with the opcode \"hello\". In this case, our block is very simple and just returns a string. REPORTER blocks are expected to return a string, number, or boolean, and BOOLEAN blocks are expected to only return a boolean. Note that <code>null</code>, <code>undefined</code>, lists, and objects are not expected return values for these blocks.</p> <p>When you want to change the extension, simply modify the extension and reload the page. Here's a tip to make your life easier: You can use the <code>?extension=</code> URL parameter to load an extension automatically instead of requiring going into the library. For example, if your extension URL is http://localhost:8080/hello-world.js, you could use https://turbowarp.org/editor?extension=http://localhost:8080/hello-world.js to load it automatically.</p> <p>If you observe that your changes aren't being applied when you refresh, try your browser's \"hard refresh\" or \"refresh without cache\" shortcuts.</p>"},{"location":"development/extensions/hello-world/#exercises","title":"Exercises","text":"<ol> <li>Change the \"Hello!\" block to return your favorite number instead. Remember to rename the block accordingly.</li> <li>Change the block's opcode.</li> <li>Add another block. Make this block use a <code>type</code> of <code>Scratch.BlockType.BOOLEAN</code> and return a boolean (true or false) at random.</li> </ol>"},{"location":"development/extensions/hello-world/#next-steps","title":"Next steps","text":"<p>Next, let's allow our blocks to take in arguments.</p>"},{"location":"development/extensions/inputs/","title":"Dealing with inputs","text":"<p>import {ExtensionCode} from './utils.js';</p> <p>Often you will want your blocks to take something in as an \"input\", \"argument\", or \"parameter\". Let's learn how to do that with a new example:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/strict-equality.js\")}</p> <p>Save this code to a file called \"strict-equality.js\" beside \"hello-world.js\", and load it the same way you loaded the hello world extension. Most of the code is very similar to the hello world extension. Notice that the strictly equals block in this extension will differentiate between \"a\" and \"A\" unlike the normal Scratch equals block.</p> <p>(If you want to use this block in your projects, see the \"Utilities\" extension on https://extensions.turbowarp.org/)</p> <p>Now let's talk about the arguments.</p> <p>:::info The argument system can be a bit finicky. If something's not working, make a bug report. :::</p> <p>To add arguments to a block, you give it an <code>arguments</code> property. It should be set to an object that contains other objects. Each property you put in <code>arguments</code> corresponds to a single argument. Each one has a name. The names can be all capitals or any format you desire.</p> <p>Here's a summary of the most common properties to set for an argument:</p> Type Description type Scratch.ArgumentType.* Determines the shape of the input and what values the default text input accepts. Most commonly Scratch.ArgumentType.STRING, Scratch.ArgumentType.NUMBER, or Scratch.ArgumentType.BOOLEAN. See the table below for acceptable values. Note that this is only a suggestion and the real type may vary. defaultValue string Optional. The default value in the toolbox. Only use this for inputs with a text box; not for boolean inputs. menu string Discussed later. <p>These are the acceptible values for type:</p> Description Example Scratch.ArgumentType.STRING Any text apple, 123, true Scratch.ArgumentType.NUMBER Any number 123 Scratch.ArgumentType.BOOLEAN True or false. This one is special as it tries to prevent users from dropping non-booleans into the input. true Scratch.ArgumentType.COLOR A hex color code #ff4c4c Scratch.ArgumentType.ANGLE A direction input. 90 means to the right. Increases counterclockwise. Same as sprite direction. 90, 180 Scratch.ArgumentType.MATRIX A 5x5 matrix represented in binary 11101010101... Scratch.ArgumentType.NOTE A note on a piano keyboard. ? Scratch.ArgumentType.IMAGE Displays an inline image, not actually an input. Described later. N/A Scratch.ArgumentType.COSTUME Names of costumes within that sprite. costume1 Scratch.ArgumentType.SOUND Names of sounds within that sprite. recording1 <p>Next, Scratch needs to know where to put each of the arguments in the block. Are they at the start, end, or somewhere in the middle? It can't guess, so you have to tell it. To do this, you use the <code>text</code> property on the block by using <code>[ARGUMENT_NAME]</code> syntax to denote where each input goes. Each argument in the <code>arguments</code> object should appear in <code>text</code> exactly once. Arguments can be in any order; it doesn't matter.</p> <p>When Scratch runs your block functions, it will pass in an object for the first value. This object will contain a value for each argument name that the block has. Conventionally we call this <code>args</code> or use destructuring syntax. As an example, if the block has an argument named <code>X</code> and <code>Y</code>, these could be accessed in any of these ways:</p> <pre><code>  // Using args.XYZ format...\n  goto(args) {\n    console.log(args.X, args.Y);\n  }\n\n  // Or using destructuring...\n  goto({X, Y}) {\n    console.log(X, Y);\n  }\n</code></pre> <p>Arguments can be a string, number, or boolean regardless of the type specified as the argument's <code>type</code>. Your code must ensure to cast values as needed.</p>"},{"location":"development/extensions/inputs/#static-menus","title":"Static menus","text":"<p>Sometimes you might prefer your blocks to have a dropdown. These are called menus. We will first discuss static menus. These are menus that contain a fixed set of items that never changes.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/strings-1.js\")}</p> <p>A similar block is available in the \"Text\" extension on https://extensions.turbowarp.org/.</p> <p>To make an argument into a menu, set its <code>type</code> to <code>Scratch.ArgumentType.STRING</code> and set its <code>menu</code> property to the name of the menu. This corresponds to a new property in the object returned by getInfo(): <code>menus</code>.</p> <p><code>menus</code> is an object of objects similar to <code>arguments</code>. Each item in <code>menus</code> is typically an object with these properties:</p> Type Description items array An array of strings. Alternatively, the items in the array can be objects containing a <code>text</code> and <code>value</code> property, both strings. acceptReporters boolean Allows people to drop complex blocks into the menu. You almost always want this to be <code>true</code>. <p>A field is an argument that can only be set to a fixed string. As an example, see the input in the \"stop all\" block. An input is an argument that can be set to any value. As an example, see the steps input in the \"move 10 steps\" block or the costume input in the \"switch costume\" block. You almost always want an input, not a field.</p> <p>While it is possible to set the menu object itself to an array, this is highly discouraged as it implicitly sets <code>acceptReporters</code> to <code>false</code> which, again, is almost never what you want. Almost every menu you use should explicitly set <code>acceptReporters</code> to true so that it is an \"input\" instead of a \"field\". The only exception to this rule is when using event-based hat blocks, which will be discussed much later. Note that switching an argument from a field to an input or the other way around is a backward-incompatible change.</p> <p>The default value will typically be the first item in the menu's item list. The item list must not be empty.</p> <p>There are some instances where you want the text that is displayed to the user in the dropdown and the value that the block receives internally to be different. For this, items can be a list of objects instead of strings (or just some of the items can be objects).</p> <p>{require(\"!raw-loader!@site/static/example-extensions/strings-2.js\")}</p> <p>Notice that, although the dropdown displays UPPERCASE in the editor, the block actually receives \"up\".</p>"},{"location":"development/extensions/inputs/#exercises","title":"Exercises","text":"<ol> <li>Add a block that does the same thing as the built-in Scratch \"join\" block. It should take two arguments and produce a new string joining them together. Make sure your block casts the arguments to strings so when someone runs \"join ((1 + 2)) ((3 + 4))\" they get \"37\" not \"10\".</li> <li>Create a boolean block that takes a number argument and a menu argument with the options \"odd\" and \"even\". The block should return whether the given number is either odd or even, as the menu says.</li> </ol>"},{"location":"development/extensions/inputs/#next-steps","title":"Next steps","text":"<p>All of the blocks up until this point have been simple and the block completes (almost) immediately, but what if the block needs to wait for something like a network request to complete?</p>"},{"location":"development/extensions/introduction/","title":"Introduction to custom extensions","text":"<p>Custom extensions are a way for you to add new blocks to TurboWarp using JavaScript.</p> <p>In this tutorial, we will describe how to build custom extensions. The pages can be navigated using the sidebar or links at the bottom of each page. We assume that you read each page in full and do the exercises listed (if any) before going to the next page.</p> <p>:::info We just rewrote this entire tutorial from the ground up.</p> <p>It uses a completely different structure and style. We hope it's easier to follow. There's a good chance there are some errors and omissions in this tutorial. Let me know what you think. Thanks! :::</p> <p>When people refer to \"extensions\", there are a few things they could be referring to:</p> Can access Scratch internals Can be loaded by URL Core extensions (pen, translate, etc.) \u2705 \u274c Sandboxed custom extensions \u274c \u2705 Unsandboxed custom extensions \u2705 \u2705 <p>The documentation in these segments refers only to custom extensions. While core extensions share many fundamentals, the process of developing them is significantly different. See getting started as a starting point for building core extensions.</p> <p>We will discuss the difference between sandboxed and unsandboxed extensions at a later time.</p>"},{"location":"development/extensions/introduction/#compatibility","title":"Compatibility","text":"<p>Custom extensions are not compatible with Scratch. Projects made using custom extensions cannot be uploaded to the Scratch website. They can, however, be packaged using the TurboWarp Packager.</p>"},{"location":"development/extensions/introduction/#prerequisites","title":"Prerequisites","text":"<p>Custom extension development requires knowledge of writing JavaScript. If you aren't familiar with JavaScript, please learn it first. Your favorite search engine can help you find places to learn. If you don't know things like the difference between <code>\"1\"</code> and <code>1</code>, developing extensions will be very difficult. As volunteers, we don't have a lot of time to spend helping you learn JavaScript -- sorry.</p> <p>Extensions can be developed using either the website or desktop app.</p> <p>We assume that you have access to the developer tools built in to your browser or the desktop app. Typically this is accessible through right click &gt; inspect element. In the desktop app, it can be shown with Ctrl+Shift+I (Option+Command+I on macOS). Writing JavaScript without access to the developer tools is extremely painful and not something we can provide help for.</p>"},{"location":"development/extensions/introduction/#tutorial-structure","title":"Tutorial structure","text":"<p>This tutorial is follows a fundamentals-up approach. We're going to start with the most basic extensions imaginable that are effectively useless and gradually build up to things that are more useful.</p> <p>We know that some of you will be eager to start sharing your extensions around, but we ask that you read through this whole tutorial before publishing your extensions or submitting them to us so that the extensions you share are actually useful.</p>"},{"location":"development/extensions/introduction/#prepare-a-development-environment","title":"Prepare a development environment","text":"<p>In recent versions of TurboWarp, there are several ways to develop extensions.</p>"},{"location":"development/extensions/introduction/#files-simplest","title":"Files (simplest)","text":"<p>Recent versions of the TurboWarp website and desktop app have an option in the custom extension menu to load extensions either from local files or from copied and pasted JavaScript code. This will be the easiest way to develop extensions as it can be done on any computer with just a text editor.</p>"},{"location":"development/extensions/introduction/#local-http-server-recommended","title":"Local HTTP Server (recommended)","text":"<p>However, if possible, you should use a local HTTP server that lets TurboWarp fetch your extension from your computer. This speeds up the process because you don't have to select/paste the JavaScript code in TurboWarp every time you make changes. There are a lot of options for installing one of these. If you have Python installed, you already have one:</p> <pre><code>cd path/to/where/you/will/store/your/extensions\npython3 -m http.server 8080\n</code></pre> <p>This starts a local HTTP server on http://localhost:8080/ in whatever folder you ran that command in.</p> <p>We will eventually introduce the official development server, but we recommend starting with the most primitive setup possible for now.</p> <p>For now, you should use a port other than 8000. We will talk more about this later, but currently we want the extensions you write to run in the sandbox. Extensions that run outside of the sandbox have some extra responsibilities that we will discuss later.</p> <p>To test that your server works, create a file called <code>hello-world.js</code> and put any text in it. Make sure you're able to read the contents of the file in your browser by visiting a link like http://localhost:8080/hello-world.js.</p>"},{"location":"development/extensions/introduction/#next-steps","title":"Next steps","text":"<p>Next, let's make your first extension.</p>"},{"location":"development/extensions/sandbox/","title":"What is the sandbox anyways?","text":"<p>There are two types of custom extensions:</p> <ul> <li>Sandboxed extensions</li> <li>Unsandboxed extensions</li> </ul> <p>This difference has a significant impact on your extensions. So far we've primarily focused on creating sandboxed extensions, but what does that mean?</p>"},{"location":"development/extensions/sandbox/#the-sandbox","title":"The sandbox","text":"<p>The sandbox is actually an <code>&lt;iframe&gt;</code>. Sandboxed extensions are run in a sandboxed cross-origin iframe that can't directly access the main page with the editor and the VM; it's stuck in its own isolated world.</p> <p>For this reason, sandboxed extensions:</p> <ul> <li>Can not access Scratch internals</li> <li>Can not access any part of the project that was not passed in as an argument, including variables</li> <li>Can not directly interact with sprites at all</li> </ul> <p>They can, however:</p> <ul> <li>Access most public APIs, as long as CORS allows it</li> <li>Access some JavaScript Web APIs, such as the Gamepad API</li> </ul> <p>It is worthwhile to note that in other Scratch mods, the extension sandbox may be a <code>Worker</code> instead of an <code>&lt;iframe&gt;</code>. We use an <code>&lt;iframe&gt;</code> instead as it is more secure (cross origin vs. same origin) and allows access to more Web APIs.</p> <p>And perhaps the biggest limitation of all is that every time a block runs, the script will pause for at least 1 frame, regardless of how simple the script is. It doesn't matter whether \"run without screen refresh\" or turbo mode is enabled. It will always wait.</p> <p>This is a very significant limitation and it makes custom extensions almost useless, which is why we introduced support for...</p>"},{"location":"development/extensions/sandbox/#unsandboxed-extensions","title":"Unsandboxed extensions","text":"<p>As the name implies, unsandboxed extensions do not run in an iframe. They run in the same context as Scratch itself as <code>&lt;script&gt;</code> tags.</p> <p>This means that unsandboxed extensions:</p> <ul> <li>CAN access Scratch internals</li> <li>CAN access parts of the project that were not passed in as an argument, such as variables</li> <li>CAN directly interact with any sprite</li> </ul> <p>And perhaps most importantly, running a block from an unsandboxed extension is actually instantaneous -- no forced 1 frame delay.</p>"},{"location":"development/extensions/sandbox/#exercises","title":"Exercises","text":"<ol> <li>Create a sandboxed extension (same as we've been building so far) with a COMMAND block that does nothing. Create a new empty project and create a repeat (10) loop that runs this block 4 times. Observe that, even though the blocks don't do anything, it takes more than a second for the loop to complete.</li> <li>In the repeat loop, replace the block from the extension with a \"set my variable to 0\" block instead. Observe that the loop completes instantly. This is how blocks from unsandboxed extensions will behave.</li> <li>Inside a custom extension, use console.log to output the value of <code>window.origin</code>. Compare this to running <code>window.origin</code> in your browser's developer console on turbowarp.org.</li> </ol>"},{"location":"development/extensions/sandbox/#next-steps","title":"Next steps","text":"<p>Unsandboxed extensions are clearly better, so let's write one.</p>"},{"location":"development/extensions/share/","title":"Sharing your extension","text":"<p>If you want to share your extension with the broader world, you'll have to find a place to put it.</p> <p>Note that, if you only care about using your own extensions in your own projects and will use the packager to share your project with others, you don't need to submit your extension anywhere as the packager always runs extensions without the sandbox.</p>"},{"location":"development/extensions/share/#sandboxed-extensions","title":"Sandboxed extensions","text":"<p>Sandboxed extensions can be hosted anywhere that offers static file hosting and HTTPS.</p> <p>A common choice is GitHub Pages. Note that GitHub's \"raw\" links (raw.githubusercontent.com) do not work; you must use GitHub Pages instead.</p>"},{"location":"development/extensions/share/#unsandboxed-extensions","title":"Unsandboxed extensions","text":"<p>The best way to share your unsandboxed extension is to submit it to extensions.turbowarp.org: https://github.com/TurboWarp/extensions/blob/master/CONTRIBUTING.md</p>"},{"location":"development/extensions/share/#exercises","title":"Exercises","text":"<ol> <li>Explore the TurboWarp Extension Gallery issue tracker for inspiration: https://github.com/TurboWarp/extensions/issues</li> </ol>"},{"location":"development/extensions/share/#next-steps","title":"Next steps","text":"<p>Wrapping up.</p>"},{"location":"development/extensions/unsandboxed/","title":"Unsandboxed extensions","text":"<p>import {ExtensionCode, Spoiler} from './utils.js';</p> <p>Unsandboxed extensions run as plain <code>&lt;script&gt;</code> tags in the main window rather than in a sandbox. They have access to a lot of new powers and responsibilities that we will discuss below.</p>"},{"location":"development/extensions/unsandboxed/#url-restrictions","title":"URL restrictions","text":"<p>To protect users from malicious extensions, extensions loaded from URLs will only run unsandboxed if their URL begins with one of these exactly:</p> <ul> <li><code>https://extensions.turbowarp.org/</code></li> <li><code>http://localhost:8000/</code></li> </ul> <p>As you don't have control over extensions.turbowarp.org, you will have to use the latter option. For this, configure your local HTTP server to run on port 8000 instead of what you've been using so far.</p> <p>When manually loading an extension from a file or JavaScript source code, there is an option to load the extension without the sandbox. This option to force an extension to run unsandboxed does not exist when using URLs due to security concerns.</p>"},{"location":"development/extensions/unsandboxed/#syntax","title":"Syntax","text":"<p>The syntax for unsandboxed extensions is very familiar but has some differences. Technically, if you just copy and paste your old sandboxed extensions as unsandboxed extensions, it will appear to just work. However, this is dangerous and is likely to cause bugs later.</p> <p>If your sandboxed extension has code like like this:</p> <pre><code>// Old sandboxed extensions (worker or &lt;iframe&gt; sandbox):\nclass MyExtension {\n  getInfo () {\n    return { /* ... */ };\n  }\n}\nScratch.extensions.register(new MyExtension());\n</code></pre> <p>Or if your extension uses an old \"plugin\" mechanism, such as this one: (if you don't recognize this code then don't worry about it)</p> <pre><code>class MyExtension {\n  getInfo () {\n    return { /* ... */ };\n  }\n}\n(function() {\n  var extensionInstance = new MyExtension(window.vm.extensionManager.runtime)\n  var serviceName = window.vm.extensionManager._registerInternalExtension(extensionInstance)\n  window.vm.extensionManager._loadedExtensions.set(extensionInstance.getInfo().id, serviceName)\n})();\n</code></pre> <p>The unsandboxed version would have code like this:</p> <pre><code>(function(Scratch) {\n  'use strict';\n  class MyExtension {\n    getInfo () {\n      return { /* ... */ };\n    }\n  }\n  Scratch.extensions.register(new MyExtension());\n})(Scratch);\n</code></pre> <p>Using this template prevents unsandboxed extensions from interfering with each other when they try to define variables, classes, or functions with the same name. By requiring everything to be defined in an immediately-invoked-function-expression (IIFE) and enabling strict mode, we prevent variables from accidentally leaking to the global scope.</p> <p>All functions and variables defined by the extension must be defined within the IIFE. Additionally, each extension must make sure to use its own personal copy of the <code>Scratch</code> API, which this template does automatically.</p> <p>An interesting thing to note about this template is that it is backward compatible with sandboxed extensions. As long as the extension doesn't use any of the features given to unsandboxed extensions, it will continue to work the same as a sandboxed extension.</p>"},{"location":"development/extensions/unsandboxed/#a-more-complete-example","title":"A more complete example","text":"<p>Here you can see a complete unsandboxed extension:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/hello-world-unsandboxed.js\")}</p> <p>If you're using a local HTTP server, save this so you can access it through the server, then load the exact URL http://localhost:8000/hello-world-unsandboxed.js in TurboWarp. If nothing appears, see the developer console. If you see an error that the extension must be run unsandboxed, most likely you are using an old version of TurboWarp or you didn't load it from a URL that starts with <code>http://localhost:8000/</code> exactly. 127.0.0.1 and 0.0.0.0 won't work! It must be localhost, port 8000 exactly.</p> <p>If you're just using files, make sure to check the \"Run extension without sandbox\" box each time you load the extension.</p> <p>Create a new empty project with a repeat (30) loop that adds the \"hello\" block to a list. Notice that it now runs instantly while the sandboxed version would've taken at least a second.</p> <p>Observe that the majority of the code is still identical: You still create a class, then call Scratch.extensions.register(), then Scratch calls getInfo() which returns the same type of object. Just the surrounding template is different.</p>"},{"location":"development/extensions/unsandboxed/#increased-power-brings-increased-responsibility","title":"Increased power brings increased responsibility","text":"<p>Before we talk about the new APIs, we want to note some additional requirements for unsandboxed extensions:</p> <ul> <li>Blocks must not throw errors. While sandboxed extensions could, unsandboxed extensions that do this may break scripts.</li> <li>Input and boolean blocks must return a valid value. While sandboxed extensions are free to neglect this, unsandboxed extensions that don't return proper values (string, number, or boolean) can break scripts in unknown ways.</li> <li>Blocks must not get stuck in infinite loops. While sandboxed extensions will usually not be able to freeze the entire window if they get stuck in a loop, unsandboxed extensions will. This can result in data loss.</li> </ul>"},{"location":"development/extensions/unsandboxed/#accessing-scratch-internals","title":"Accessing Scratch internals","text":"<p>The big thing that unsandboxed extensions can do is directly access Scratch internals.</p> <pre><code>  const vm = Scratch.vm;\n</code></pre> <p>That's full access to the actual Scratch VM object. There is a lot you can do with this.</p> <p>Remember -- every variable declaration must happen inside the IIFE.</p> <pre><code>// GOOD CODE\n(function(Scratch) {\n  const vm = Scratch.vm;\n  // ...\n}(Scratch));\n\n// BAD CODE\nconst vm = Scratch.vm;\n(function(Scratch) {\n  // ...\n}(Scratch));\n</code></pre> <p>Dig around for a while to find what you're looking for. Your developer tools will be immensely useful as you can access <code>Scratch</code> from there after an extension is loaded, or use the other debugging global variables that are available (but please don't use those in extensions). You may find the scratch-vm source code or @turbowarp/types to be useful resources.</p> <p>Here is an example of an extension that uses Scratch.vm to toggle turbo mode, similar to the \"runtime options\" extension on extensions.turbowarp.org:</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/turbo-mode.js\")}</p>"},{"location":"development/extensions/unsandboxed/#the-block-utility-object","title":"The block utility object","text":"<p>When a sandboxed custom extension is run, all it receives are the arguments that the scripts provided. It doesn't even know which sprite is executing it. We now introduce the second argument passed to block functions: BlockUtility.</p> <p>The BlockUtility object, conventionally called <code>util</code>, allows blocks in unsandboxed extensions to get direct access to the sprite that is running them using <code>util.target</code>. Similar to the VM, this is the actual object used internally. You have full access to it.</p> <p>Here is an example extension that demonstrates using <code>util.target</code> to get the name of the current sprite or access variables.</p> <p>{require(\"!raw-loader!@site/static/example-extensions/unsandboxed/block-utility-examples.js\")}</p> <p>Note that every sprite, script, and block shares the same block utility object. Instead of making a object each time your block runs, it just updates the properties of the shared object for performance. Thus, the only safe time to access <code>util</code> is immediately when the block runs. Trying to access <code>util</code> in a setTimeout, setInterval, Promise callback, or other non-syncronous callback will not work correctly. If you need to access properties from <code>util</code> later, save them in a variable ahead of time.</p> <pre><code>  // This is NOT reliable and may alert the wrong thing:\n  myBlock(args, util) {\n    setTimeout(() =&gt; {\n      alert(util.target.getName());\n    }, 1000);\n  }\n\n  // This will always work:\n  myBlock(args, util) {\n    const target = util.target;\n    setTimeout(() =&gt; {\n      alert(target.getName());\n    }, 1000);\n  }\n</code></pre>"},{"location":"development/extensions/unsandboxed/#common-templates","title":"Common templates","text":"<p>Here are some common copy-and-pasteable code snippets that can be used:</p> <p>If the extension MUST be run unsandboxed, add this around the start:</p> <pre><code>  if (!Scratch.extensions.unsandboxed) {\n    throw new Error('Extension Name must run unsandboxed');\n  }\n</code></pre> <p>If you're using the <code>vm</code>, <code>runtime</code> or <code>Cast</code> APIs a lot, common practise is to define them around the start to save time:</p> <pre><code>  const vm = Scratch.vm;\n  const runtime = vm.runtime;\n  const Cast = Scratch.Cast; // Discussed later.\n</code></pre>"},{"location":"development/extensions/unsandboxed/#permissioned-apis","title":"Permissioned APIs","text":"<p>Whereas sandboxed extensions are free to use APIs such as fetch() as they please, unsandboxed extensions should instead ask for permission before making a request to any remote service. This gives the user control over their privacy. While there are no technical measures enforcing this at runtime, it is required for all extensions on extensions.turbowarp.org.</p> <p>Requests to some popular services such as GitHub Pages or GitLab Pages may be automatically approved, while requests to other random websites may show a prompt to the user. You shouldn't make any assumptions about this, and your code needs to ensure that it can gracefully handle the user rejecting the prompt (the extension should behave the same as it does when there is no internet connection).</p> <p>These permissioned APIs will also automatically prevent projects from running arbitrary JavaScript by attempting to, for example, redirect to a <code>javascript:</code> URL.</p>"},{"location":"development/extensions/unsandboxed/#fetching-apis-websockets-images-audio-files-etc","title":"Fetching APIs, WebSockets, images, audio files, etc.","text":"<p>Use <code>Scratch.fetch(url)</code> instead of <code>fetch(url)</code>. Check <code>await Scratch.canFetch(url)</code> before using other APIs that connect to remote websites.</p> <pre><code>// Do not do this:\nconst response = await fetch(url);\n// Do this instead:\nconst response = await Scratch.fetch(url);\n\n// Do not do this:\nconst ws = new WebSocket(url);\n// Do this instead:\nif (await Scratch.canFetch(url)) {\n  const ws = new WebSocket(url);\n}\n\n// Do not do this:\nconst image = new Image();\nimage.src = src;\n// Do this instead:\nif (await Scratch.canFetch(src)) {\n  const image = new Image();\n  image.src = src;\n}\n\n// Do not do this:\nconst audio = new Audio(url);\n// Do this instead:\nif (await Scratch.canFetch(url)) {\n  const audio = new Audio(url);\n}\n</code></pre>"},{"location":"development/extensions/unsandboxed/#opening-new-tabs-or-windows","title":"Opening new tabs or windows","text":"<p>Use <code>Scratch.openWindow(url)</code> instead of <code>window.open(url)</code>. <code>Scratch.openWindow</code> always sets the target to <code>\"_blank\"</code> to open a new tab or window. If you can't use <code>Scratch.openWindow(url)</code> for some reason, check <code>await Scratch.canOpenWindow(url)</code> before calling <code>window.open(url)</code>.</p> <pre><code>// Do not do this:\nconst win = window.open(url);\n// Do this instead:\nconst win = await Scratch.openWindow(url);\n\n// Do not do this:\nconst win = window.open(url, '_blank', 'width=400,height=400')\n// Do this instead:\nconst win = await Scratch.openWindow(url, 'width=400,height=400');\n</code></pre>"},{"location":"development/extensions/unsandboxed/#redirecting-the-current-page","title":"Redirecting the current page","text":"<p>Use <code>Scratch.redirect(url)</code> instead of <code>location.href = url</code>. If you can't use <code>Scratch.redirect(url)</code>, check <code>await Scratch.canRedirect(url)</code> before running <code>location.href = url</code>.</p> <pre><code>// Do not do this:\nlocation.href = url;\n// Do this instead:\nawait Scratch.redirect(url);\n</code></pre>"},{"location":"development/extensions/unsandboxed/#exercises","title":"Exercises","text":"<p>We encourage you to try to figure these out without the hints. It will make you much more familiar with how VM internals work.</p> <ol> <li>Create a block that presses the green flag. (Hint: vm.greenFlag)</li> <li>Create a block that returns the x position of the sprite, similar to the \"x position\" block. (Hint: target.x)</li> <li>Create a block that moves the sprite to the center of the screen, similar to \"go to x: 0 y: 0\". (Hint: target.setXY(x, y))</li> </ol>"},{"location":"development/extensions/unsandboxed/#next-steps","title":"Next steps","text":"<p>Depending on the server you've been using, you might be tired of remembering to hard-reload all of the time. Let's learn about a better development server.</p>"},{"location":"development/extensions/wrapping-up/","title":"Wrapping up","text":"<p>We hope that you found this tutorial helpful. Please give feedback and ask questions:</p> <ul> <li>Feedback about the tutorial: https://scratch.mit.edu/users/GarboMuffin/#comments</li> <li>Bug tracker and suggestion tracker: https://github.com/TurboWarp/extensions/issues</li> <li>General discussion: https://github.com/TurboWarp/extensions/discussions</li> </ul> <p>Thank you for reading this far.</p>"},{"location":"development/extensions/wrapping-up/#remaining-topics-to-include-in-the-future","title":"Remaining topics to include in the future","text":"<ul> <li>Dynamic menus</li> <li>Block utility stack frames, yield, yieldTick, etc.</li> <li>C-shape blocks such as \"if\", \"if else\", \"repeat\"</li> </ul>"},{"location":"packager/commercial-use/","title":"Can I sell projects made with the TurboWarp Packager?","text":"<p>:::note We are not lawyers. This page is not legal advice. Talk to a real lawyer if this is important. :::</p> <p>Yes, if you have the rights to all the costumes, sounds, scripts, and extensions inside the project you package, it is possible to sell it.</p> <p>The TurboWarp Packager is provided under a free and open source license. You can use files generated by the packager in any way with no license fee and no royalty. In place of a license fee, we ask you to donate to and volunteer at charity organizations in your local community. They need your support far more than I do. Make your community a better place.</p> <p>:::warning The TurboWarp Packager offers no warranty. The authors can not be held liable for any damages. :::</p> <p>If you used costumes, sounds, scripts, or extensions created by other people, make sure you have permission from those people to sell their work. If you found something on the Scratch website, you should probably ask the creator for permission before using it. The license for content found on Scratch is currently quite ambiguous. If you want to use a Scratch trademark, you should probably ask the Scratch Foundation about that too.</p>"},{"location":"packager/dynamic-stage-resize/","title":"Dynamic stage resize","text":"<p>:::info This page is about the TurboWarp Packager. :::</p> <p>Dynamic stage resize will change the size of the stage to match whatever aspect ratio and resolution it's being displayed at.</p> <p>The stage isn't scaled; the size actually changes. For example, if the user enables fullscreen on a 1920x1080 monitor, then the stage resizes to 1920x1080. If the user resizes the window to 1x1, it will also resize to that, so you should consider adding a minimum size check.</p> <p>Almost no projects will handle this properly. To make your project compatible:</p> <ul> <li>First, make it compatible with custom stage size at all (see that page for information)</li> <li>Then, change your stage size detection logic to run every frame and make sure to always update the positions of items (yes this is inefficient and strange, but it's plenty fast and the best choice for now)</li> </ul>"},{"location":"packager/embedding/","title":"Embedding the packager","text":"<p>:::info This page is about the TurboWarp Packager. If you just want an easy way to embed a Scratch project into a website, see the other embedding page. :::</p> <p>You can embed the output of the TurboWarp Packager into another website:</p> <pre><code>&lt;iframe src=\"path_to_project.html\" width=\"480\" height=\"360\" allowtransparency=\"true\" frameborder=\"0\" scrolling=\"no\" allowfullscreen&gt;&lt;/iframe&gt;\n</code></pre> <p>Depending on the environment you used, where you stored the project, and what you named it, the <code>src</code> attribute will vary.</p> <ul> <li>If you used \"Plain HTML\", it's just the path to the HTML file.</li> <li>If you used \"Zip\", it's the path to the file <code>index.html</code> contained within the extracted zip.</li> </ul> <p>If you have controls enabled, add 48 to the value of <code>height</code> to avoid the stage getting shrunk.</p>"},{"location":"packager/home/","title":"TurboWarp Packager","text":"<p>Info</p> <p>Use the TurboWarp Packager here: https://packager.turbowarp.org/</p> <p>The TurboWarp Packager converts Scratch projects into HTML files, zip archives, or executable programs for Windows, macOS, and Linux. It's like HTMLifier and the forkphorus packager.</p> <p>This is the place where some extra documentation goes. Use the sidebar on the left to navigate.</p>"},{"location":"packager/offline/","title":"Offline Packager","text":"<p>There are ways to use the TurboWarp Packager offline which can be useful in various circumstances (for example, perhaps your school blocks turbowarp.org).</p> <p>We aim to update the offline packager about once a month.</p> <p>Large assets such as Electron, NW.js, or WKWebView executables are not included in the offline packager and will be downloaded separately as needed. The packager will try to cache these files offline after you download them the first time, so they should only have to be downloaded once. Usually these downloads will still work even if your school blocks turbowarp.org.</p>"},{"location":"packager/offline/#desktop","title":"Desktop App","text":"<p>You can download TurboWarp Desktop, which includes an offline version of the packager. You can access it by pressing the \"(?)\" button in the top right corner then select the packager.</p> <p>The built-in packager will automatically load the project you have open in the editor.</p>"},{"location":"packager/offline/#html","title":"Standalone HTML","text":"<p>If you can't or don't want to download the desktop app, you can download the standalone HTML versions from GitHub instead. Visit https://github.com/TurboWarp/packager/releases and download \"turbowarp-packager-standalone-x.x.x.html\" under \"Assets\" from the top release. You can simply open the HTML file in your browser.</p> <p>The HTML file does not include any update checker. You will have to handle check for and handle updates on your own.</p>"},{"location":"packager/offline/#pwa","title":"Web App","text":"<p>The https://packager.turbowarp.org/ is a web app that tries to function offline after loading it once. This is still experimental and we do not recommend relying on this.</p>"},{"location":"packager/special-cloud-behaviors/","title":"Special cloud behaviors","text":"<p>:::info This page is about the TurboWarp Packager. :::</p> <p>The disabled-by-default \"Special cloud behaviors\" option changes the behavior of specifically named cloud variables to unlock new compatibilities for your project. This is based on a similar feature in HTMLifier. This feature can be enabled in the \"Cloud variables\" section.</p> <p>To make these, just create a cloud variable as you normally would but give them the specific name found below. For example, to use the <code>\u2601 url</code> variable, create a variable named <code>url</code> and mark it as a cloud variable.</p> <p>Enabling special cloud behaviors will override any other settings for these variables, so a variable like <code>\u2601 username</code> will never be stored locally or synced with other users.</p>"},{"location":"packager/special-cloud-behaviors/#url","title":"\u2601 url","text":"<p>The value of <code>\u2601 url</code> will be set to the page's current URL. Changing the value of <code>\u2601 url</code> does nothing.</p>"},{"location":"packager/special-cloud-behaviors/#redirect","title":"\u2601 redirect","text":"<p>When the value of <code>\u2601 redirect</code> is set to a URL, the current tab will navigate to that URL.</p>"},{"location":"packager/special-cloud-behaviors/#open-link","title":"\u2601 open link","text":"<p>When the value of <code>\u2601 open link</code> is set to a URL, the project will attempt to open a new tab with that URL open. Note that this isn't always reliable due to the popup blockers built in to most browsers.</p>"},{"location":"packager/special-cloud-behaviors/#username","title":"\u2601 username","text":"<p>When the value of <code>\u2601 username</code> is changed, the value of the <code>username</code> block in the sensing category will change.</p>"},{"location":"packager/special-cloud-behaviors/#pasted","title":"\u2601 pasted","text":"<p>When the user pastes some text onto the page using a shortcut like ctrl+v, the text is stored in <code>\u2601 pasted</code>.</p>"},{"location":"packager/special-cloud-behaviors/#set-clipboard","title":"\u2601 set clipboard","text":"<p>When the value of <code>\u2601 set clipboard</code> is changed, the page will try to store the text in the user's clipboard. This might not always work.</p>"},{"location":"packager/special-cloud-behaviors/#room-id","title":"\u2601 room id","text":"<p>When the value of <code>\u2601 room id</code> is changed, the project ID used for syncronizing cloud variables is changed. For example, if the the project's original ID is 1234 and <code>\u2601 room id</code> is set to <code>xyz</code>, the new project ID will be <code>1234-xyz</code>. To reset the project ID to the original ID, set the value of <code>\u2601 room id</code> to an empty string.</p> <p>This can be useful as a way to add a server selector to cloud variable projects without having to create a bunch of extra variables. Only people with the same room ID will have variables synced between them. It could take a couple seconds for cloud variables to begin working again as it has to reconnect to the cloud variable server.</p> <p>The room ID does not affect locally stored cloud variables.</p>"},{"location":"packager/special-cloud-behaviors/#eval","title":"\u2601 eval","text":"<p>:::warning This option requires \"Unsafe special cloud behaviors\" to be enabled.</p> <p>Unsafe cloud behaviors allows the packaged project to execute arbitrary code outside of the \"sandbox\" that projects are typically executed in. Depending on the environment you're packaging for, this grants projects full control over your computer, including the ability to install viruses.</p> <p>If you do not trust the project you're packaging or don't make use of this feature, please turn off this option. :::</p> <p>When the value of <code>\u2601 eval</code> is changed, its value will be evaluated as JavaScript.</p> <p>If the JavaScript is successfully evaluated, its output will be stored in <code>\u2601 eval output</code>.</p> <p>If there was an error evaluating the JavaScript, the error will be stored in <code>\u2601 eval error</code>.</p> <p>If the JavaScript returns a Promise, it will store the resolved value in <code>\u2601 eval output</code> if the promise resolves, or the error in <code>\u2601 eval error</code> if it rejects. Note that setting <code>\u2601 eval</code> is always an instant process, so the output variables may not update immediately.</p>"},{"location":"packager/special-cloud-behaviors/#further-information","title":"Further information and discussion","text":"<p>See https://github.com/TurboWarp/packager/issues/48</p>"},{"location":"website/","title":"\u57fa\u7840","text":"<p>\u8fd9\u91cc\u662f TurboWarp \u7684\u6587\u6863\uff0c\u6211\u4eec\u5c06\u5176\u7ffb\u8bd1\u4e3a\u4e86\u4e2d\u6587\uff0c\u8ba9\u60a8\u66f4\u597d\u7406\u89e3\u3002</p>"},{"location":"website/cloud-variables/","title":"Cloud Variables","text":"<p>TurboWarp has its own cloud variable server independent of Scratch.</p> <p>Some things to keep in mind:</p> <ul> <li>Anyone can change their username using the \"Edit &gt; Change Username\" menu. A user who appears to be named \"griffpatch\" is most likely not the real griffpatch.</li> <li>To reduce abuse, the cloud variable server rejects any username that doesn't belong to an existing Scratch account.</li> <li>Names of Scratch Team members cannot be used due to potential abuse. That includes ScratchCat.</li> <li>The variable length limit has been increased to 100000 characters.</li> <li>Cloud variables can still only hold numbers.</li> <li>Cloud variables are reset whenever the server restarts or when no one is in the project for a short period of time, so things like leaderboards won't be saved very long.</li> <li>Cloud variables are disabled when the editor is opened.</li> <li>Do not abuse cloud variables to make unmoderated chat rooms.</li> <li>There are no public cloud variable history logs.</li> <li>Sensing colors or motion using the video sensing extension is disabled when cloud variables or custom extensions are used.</li> </ul>"},{"location":"website/cloud-variables/#advanced","title":"For bot developers and advanced users","text":"<p>We allow and encourage developing bots and custom clients. However, due to persistent abuse, we ask you to follow a few rules. Remember that this is a free service operated by volunteers. The CPU to parse messages and the bandwidth to send messages to other users is not free. The information below is applicable to both users and authors of cloud variable libraries.</p>"},{"location":"website/cloud-variables/#protocol","title":"Protocol","text":"<p>The protocol is the same as Scratch's cloud variables. We provide a barebones reference library for Node.js. As the protocol is fully open, you do not need to use our library if you don't want to.</p>"},{"location":"website/cloud-variables/#user-agent","title":"User-Agent is required","text":"<p>Bots must provide a valid User-Agent header in their connection. That includes contact information (such as a Scratch profile link, email address, GitHub issue page, etc.) and the name and version of the cloud variable library being used (if applicable). Exact syntax does not matter; just needs to be human readable. Some examples of good User-Agents:</p> <ul> <li><code>multiplayer leaderboard bot by https://scratch.mit.edu/users/TestMuffin</code></li> <li><code>cloud-variable-library/1.0.1 contact@example.com</code></li> </ul> <p>The only exception is if your bot is running in a browser where you can't control the User-Agent. In this case, your browser will automatically include other headers like Origin with the name of your website anyway. Pretending to be a browser is not okay and is easy to detect.</p> <p>Ask the author of your cloud variable library or refer to your WebSocket library's documentation about custom headers to learn how to add a User-Agent.</p> If you are developing a cloud variable library  You should expose an API to set the User-Agent, and you should make using this API mandatory. For example, for some hypothetical cloud variable API, you might have an option like this:  <pre><code>const CloudConnection = require('...');\n\nconst connection = new CloudConnection({\n    username: '...',\n    projectId: '...',\n    // highlight-start\n    // UPDATE THIS!\n    contactInformation: 'contact@example.com'\n    // highlight-end\n});\n\nconnection.on('connected', () =&gt; { /* ... */ });\nconnection.on('set', (name, value) =&gt; { /* ... */ });\n</code></pre>  Your library will see the `contactInformation` option and concatenate it with the name and version of your library, resulting in a final User-Agent like `CloudConnectionLib/0.3.3 contact@example.com`.  If someone does not specify `contactInformation`, you should not let them continue anyways. User-Agents that are lacking information will be blocked, and you will end up with nonsense bug reports from users saying \"cloud variable wont connect\" with no further details. Good luck diagnosing that! Instead, give them a nice error message so they can figure it out without bothering you.  To actually set the User-Agent, look at the documentation for the WebSocket library you use. They probably won't mention User-Agent specifically, but they should mention how to set headers in general. For example, using the Node.js [ws](https://www.npmjs.com/package/ws) client, you would do:  <pre><code>const ws = new WebSocket(\"wss://clouddata.turbowarp.org\", {\n  headers: {\n    \"user-agent\": userAgentGoesHere\n  }\n});\n</code></pre>"},{"location":"website/cloud-variables/#project-id","title":"Project ID","text":"<p>Project IDs are not limited to just numbers -- they can be any text you want. If you're using a custom ID for a project that doesn't live on the Scratch website, use text like <code>example.com/my-project</code> so that we can verify your project is legitimate. If we see a lot of cloud variable activity using a project ID that doesn't make sense, we will disable that project ID.</p> If you are developing a cloud variable library  For this reason, your project ID options should be strings, not an integer or other numeric type."},{"location":"website/cloud-variables/#username","title":"Usernames","text":"<p>The cloud variable protocol requires you to provide a username. The server tries to ensure that all usernames are safe before allowing the connection. We recommend just setting the username to <code>player</code> followed by between 2 and 7 random numbers as your connection will start faster (we won't ask the Scratch API to validate it). If your bot needs a specific username, store it in a separate variable.</p> If you are developing a cloud variable library  As long as you are forcing users to have a valid User-Agent, the username is redundant, so you can eschew the username option and generate a random one automatically."},{"location":"website/cloud-variables/#one-connection","title":"Don't rapidly open and close connections","text":"<p>We've seen a pattern of bots opening a connection, closing it, and then immediately opening a new one in an endless loop. The end result is a slow bot that uses way more network and CPU resources than it has any reason to, which is not allowed. We think this is because some poorly designed libraries have APIs that let people write code like this:</p> <pre><code>while True:\n    value = cloudlibrary.get_var(project_id, username, user_agent, variable_name)\n    print(f\"{variable_name} is {value}\")\n</code></pre> <p>Where <code>cloudlibrary.get_var</code> is implemented by opening a connection and then closing it immediately. Instead, libraries should offer event-driven APIs. Instead of constantly asking the server for the latest values, open exactly one WebSocket, and let the server send updates as they happen. WebSockets are very efficient: If no variables are changing, the connection remains idle. If there are a lot of variables changing, you'll get the updates as soon as possible. Equivalent code might instead be:</p> <pre><code>def on_set(name, value):\n    print(f\"{name} is {value}\")\nconnection = cloudlibrary.connect(project_id, username, user_agent, on_set)\n</code></pre> <p>It is possible to offer an API like <code>get_var</code> as long as the implementation is event-driven and uses one connection internally (then <code>get_var</code> just returns the most recently received value). It just takes a little bit of work.</p>"},{"location":"website/cloud-variables/#buffering","title":"Updates are buffered","text":"<p>For performance, the server will buffer up several cloud variable updates to send out as one group. Updates are not guaranteed to be sent in the same order they are received, and some updates may be skipped entirely. Because of this buffering, sending updated variables more than 10 times per second is completely redundant.</p>"},{"location":"website/cloud-variables/#pings","title":"Respond to pings","text":"<p>The server will periodically send a WebSocket ping frame, and you must respond with a pong or else the connection will drop. Refer to the documentation for your WebSocket library to see how to enable ping/pong support if it isn't enabled by default.</p>"},{"location":"website/cloud-variables/#debug","title":"Important debug information","text":"<p>To make things easier for us, you, and anyone using your library, please log these things somewhere (such as in error messages) instead of silently ignoring them:</p> <ul> <li>WebSocket close codes. All of the 4XXX codes are listed in this table. Would you rather see <code>connection closed</code> or <code>connection closed with code 4002</code>? Looking up the latter's code in the table makes it clear that the username is the problem.</li> <li>Invalid JSON received from the server. If the server has something to tell you beyond just what the close code table says, it might send you a plain English sentence instead of a JSON object. When your JSON parser throws an error, you should log the actual raw text received from the server so you get error messages like <code>Received invalid JSON from server: The cloud data library you are using is putting your Scratch account at risk by sending us your login token for no reason</code> instead of <code>JSON.parse: unexpected character at line 1 column 1 of the JSON data</code>. Which of those would you rather see?</li> </ul>"},{"location":"website/cors/","title":"CORS: Why your fetch block doesn't work","text":"<p>Anyone who's used the Fetch, HTTP, Network and similar extensions has noticed that when you try to fetch certain websites, even after pressing \"Allow\", the block just doesn't work:</p> <p></p> <p>The reason for this is called CORS, a security feature that limits how websites can interact.</p>"},{"location":"website/cors/#cors","title":"What is CORS?","text":"<p>It stands for Cross-Origin Resource Sharing, but we're not going to dive into the internal details very much -- other places have already done that. The core problem that CORS solves is simple to understand:</p> <ul> <li>Some websites want to block access from other websites</li> <li>Other websites want to allow access from other websites</li> </ul> <p>Imagine if any website you visited could access your bank's website as though they were you. That would be quite bad! But sometimes this access is not a problem and actually intended. Parts of Scratch's API enable CORS, which is how TurboWarp loads projects from Scratch.</p> <p>CORS is the way that a website declares whether they want other websites to be able to access theirs. By default, access is not allowed. Websites have to opt in to CORS which lets other websites access them. If a website doesn't opt in, your browser will give TurboWarp a very generic \"Network error\".</p>"},{"location":"website/cors/#workarounds","title":"How to fix your blocks","text":"<p>It depends on what the URL is for.</p> <ul> <li>Switch to a different URL: If the URL is just being used to host static files, find another host that supports direct downloads and CORS. If one API doesn't support CORS, check if a competitor's API does.</li> <li>Use a CORS proxy: Instead of asking your browser to access a website directly, you can ask another server (called a CORS proxy) to access that website on your behalf and then send back the response but allowing CORS. There are many public CORS proxies that you can find online, but they tend to be short lived as they are expensive to operate and heavily abused. CORS proxies can also spy on your project's web requests, as well as tamper with them. This can often be problematic. TurboWarp does not currently run its own CORS proxy.</li> <li>Switch to TurboWarp Desktop: The desktop app has an option to bypass CORS. See below.</li> </ul>"},{"location":"website/cors/#desktop","title":"Desktop app","text":"<p>In TurboWarp Desktop, there is an option to bypass CORS to allow access to any website. For security reasons it's disabled by default to match normal web browsers. Open up Desktop Settings under the Settings button in the top left (in older versions Desktop Settings is under the ? button in the top right instead):</p> <p>import settingsMenu from './assets/desktop-settings.png';</p> <p></p> <p>When the desktop settings window opens, check the box by \"Allow extensions to access any website\".</p>"},{"location":"website/cors/#packaged-projects","title":"Packaged projects","text":"<p>Packaged projects running in a browser are subject to the same limitations as any other website.</p> <p>Projects that are packaged to Electron apps bypass CORS by default, similar to the option in the desktop app.</p>"},{"location":"website/cors/#servers","title":"If you are running a server","text":"<p>If you want websites to be able to access your website, set the <code>Access-Control-Allow-Origin</code> header to <code>*</code> in each response you want to be public. If you search the name of the web server or framework you're using followed by \"cors\", you should find plenty of examples.</p>"},{"location":"website/donate/","title":"Donations","text":"<p>TurboWarp stopped accepting donations in July 2025 due to a lack of time availability and to avoid a perceived conflict of interest with my employer.</p> <p>Instead, please donate to and volunteer at charity organizations in your local community. They need your support far more than I do. Make your community a better place.</p>"},{"location":"website/embedding/","title":"Embedding","text":"<p>You can use TurboWarp to embed a Scratch project in your website using an <code>&lt;iframe&gt;</code>. For the best experience, use this template:</p> <pre><code>&lt;iframe src=\"https://turbowarp.org/414716080/embed\" width=\"482\" height=\"412\" allowtransparency=\"true\" frameborder=\"0\" scrolling=\"no\" allowfullscreen=\"\" style=\"color-scheme: auto\"&gt;&lt;/iframe&gt;\n</code></pre> <p>You should change these attributes appropriately:</p> <ul> <li><code>src=\"https://turbowarp.org/414716080/embed\"</code> contains the ID of the project you want to embed. You should change this. We're using 414716080 as an example, but you can replace that number with any other project ID. You can also include other URL paramters as listed below.</li> <li><code>width=\"482\" height=\"412\"</code> defines the size of the embed. The player will automatically resize to whatever you specify here, so you can change the numbers. The border around the stage takes two pixels of width and height, and the controls take an extra 50 pixels of height. Thus, to get a 480x360 stage, you would use 482 and 412.</li> <li>Optionally, you may want to add <code>loading=\"lazy\"</code> to the attributes which lets the browser wait to load the iframe until the user scrolls closer to it. This can improve performance if the embed is pretty far down the page and doesn't need to be loaded right away.</li> </ul> <p>The rest of the attributes should not be changed. Here's what they do if you were curious:</p> <ul> <li><code>allowtransparency=\"true\"</code> allows the embed to have a transparent background, so any color or images you have behind the embed can still be seen.</li> <li><code>frameborder=\"0\"</code> removes an ugly border around the iframe.</li> <li><code>scrolling=\"no\"</code> ensures that there won't be any unexpected scrollbars in the iframe.</li> <li><code>allowfullscreen=\"\"</code> allows the fullscreen button to work. If this attribute is removed or if the device does not support fullscreen, the button will not show up.</li> <li><code>style=\"color-scheme: auto\"</code> ensures that the embed's transparent background works if your page uses the dark color-scheme. This attribute doesn't let you control how the stuff inside the embed appears. It just fixes the transparency.</li> </ul> <p>Here's what that example embed looks like in action:</p>"},{"location":"website/embedding/#unshared-projects","title":"Unshared projects can't be embedded","text":"<p>Unshared projects can not be shown in embeds. Make sure the projects you embed are shared or use the TurboWarp Packager instead.</p>"},{"location":"website/embedding/#url-parameters","title":"URL parameters","text":"<p>All standard URL Parameters are still available. You can use these to control usernames and other things.</p> <p>There are also some special parameters only available in embeds:</p>"},{"location":"website/embedding/#autoplay","title":"Autoplay","text":"<p>Embeds support the <code>autoplay</code> parameter, which will automatically hit the green flag when the project loads. For example: https://turbowarp.org/15832807/embed?autoplay</p> <p>Note that sound blocks may not work until the user interacts with the project (for example, by clicking). This is a restriction imposed by browsers. There is nothing TurboWarp can do to work around this.</p>"},{"location":"website/embedding/#settings-button","title":"Settings button","text":"<p>You can optionally enable a settings button in embeds with the <code>settings-button</code> parameter that opens a similar menu to the \"Advanced settings\" menu found in the website and editor. For example: https://turbowarp.org/15832807/embed?autoplay&amp;settings-button</p>"},{"location":"website/embedding/#fullscreen-background","title":"Fullscreen background color","text":"<p>Outside of fullscreen mode, the embed is transparent so you can style the parent element if you want to change the background color.</p> <p>In fullscreen mode, the embed will either use a white or an almost black color depending on whether the user's computer is configured to dark mode or not.</p> <p>To override this behavior, set the <code>fullscreen-background</code> parameter to a CSS color value like <code>black</code> or <code>rgb(50,90,100)</code>. For example: https://turbowarp.org/15832807/embed?fullscreen-background=yellow</p> <p>You can also use hex colors if you escape the <code>#</code> with percent encoding: <code>%23abc123</code>.</p>"},{"location":"website/embedding/#addons","title":"Addons","text":"<p>By default, embeds have no addons enabled. This can be overridden with the <code>addons</code> parameter, which is a comma separated list of addon IDs to enable. For example: https://turbowarp.org/15832807/embed?addons=pause,gamepad,mute-project</p> <p>Useful addons and their IDs:</p> <ul> <li>\"Pause button\" is <code>pause</code></li> <li>\"Muted project player mode\" is <code>mute-project</code></li> <li>\"Remove curved stage border\" is <code>remove-curved-stage-border</code></li> <li>\"File drag and drop\" is <code>drag-drop</code></li> <li>\"Gamepad support\" is <code>gamepad</code></li> <li>\"Reverse order of project controls\" is <code>editor-buttons-reverse-order</code></li> <li>\"Clone counter\" is <code>clones</code></li> </ul> <p>Other addons will have no effect on the embed.</p>"},{"location":"website/embedding/#security","title":"Security considerations","text":"<p>If you use user-supplied information to generate embed links, you should sanitize any arguments to make sure users can't supply arbitrary URL parameters as some can lead to unexpected behaviors.</p>"},{"location":"website/embedding/#packager","title":"Need more control?","text":"<p>Use the TurboWarp Packager for more control over the loading screen, accent colors, controls, and more. You can also embed the output of the packager very easily.</p>"},{"location":"website/embedding/#license","title":"License","text":"<p>TurboWarp is licensed under the GPLv3.0. We believe that an <code>&lt;iframe&gt;</code> of a GPLv3.0 work doesn't create a derivative work under the GPLv3.0, rather it creates an \"aggregate work\" which is not subject to the same requirements as derivative works. However, we are not lawyers and this is not legal advice. Talk to a lawyer if this matters to you.</p>"},{"location":"website/how-it-works/","title":"How TurboWarp runs Scratch projects 10-100x faster","text":"<p>TurboWarp uses a compiler while Scratch uses an interpreter. This allows TurboWarp to run somewhere between 10-100x faster depending on the project, but it makes live script editing impracticable.</p> Test Scratch TurboWarp Quicksort Sort 200000 random items Lower is better 8.871 seconds 0.0451 seconds Cycles Raytracer res=1 samp=10 dof=.08 Lower is better 814 seconds 15 seconds Faster SHA-256 Hash Hashes per second Higher is better 146 per second 3010 per second <p>(Tested using Chromium 140, Arch Linux, i7 4790k)</p> <p>Consider the following script:</p> <p></p> <p>Scratch's interpreter walks an abstract syntax tree at runtime. Internally that looks like this:</p> <pre><code>{\n  \"va[U{Cbi_NZpSOSx_kVA\": {\n    \"opcode\": \"event_whenflagclicked\",\n    \"inputs\": {},\n    \"fields\": {},\n    \"next\": \"tzXnZ{8G!xK|t^WAWF{m\",\n    \"topLevel\": true\n  },\n  \"tzXnZ{8G!xK|t^WAWF{m\": {\n    \"opcode\": \"control_forever\",\n    \"inputs\": {\n      \"SUBSTACK\": {\n        \"name\": \"SUBSTACK\",\n        \"block\": \"$xf$bq|xl(}RhT-K,taS\"\n      }\n    },\n    \"fields\": {},\n    \"next\": null,\n    \"topLevel\": false\n  },\n  \"$xf$bq|xl(}RhT-K,taS\": {\n    \"opcode\": \"motion_movesteps\",\n    \"inputs\": {\n      \"STEPS\": {\n        \"name\": \"STEPS\",\n        \"block\": \"cw__.I:g}Y~`:5KmO00q\"\n      }\n    },\n    \"fields\": {},\n    \"next\": null,\n    \"topLevel\": false\n  },\n  \"cw__.I:g}Y~`:5KmO00q\": {\n    \"opcode\": \"data_variable\",\n    \"inputs\": {},\n    \"fields\": {\n      \"VARIABLE\": {\n        \"name\": \"VARIABLE\",\n        \"id\": \"`jEk@4|i[#Fk?(8x)AV.-my variable\"\n      }\n    },\n    \"next\": null,\n    \"topLevel\": false\n  }\n}\n</code></pre> <p>Whenever Scratch executes any block, it has to do a lot of things:</p> <ul> <li>It has to look up the block using its ID and which function the block's opcode corresponds to.</li> <li>If the block has inputs, those are also blocks, and must go through the same steps as any other block, and so must any deeper inputs.</li> <li>It manually maintains a stack of blocks, loops, conditions, procedures, etc.</li> <li>Scratch scripts can be yielded, so all of this has to happen in a way that can be paused and resumed later.</li> <li>Scratch scripts can be changed while they're running, so caching everything ahead of time is difficult.</li> <li>etc. There is a lot going on in Scratch whenever it executes even a single block.</li> </ul> <p>The interpreter overhead is added on top of the overhead of JavaScript itself. As this code involves many dynamic types, it can be hard for the JavaScript JIT to optimize it.</p> <p>TurboWarp's compiler removes all of that overhead by converting scripts directly to JavaScript functions. For example, the above script becomes:</p> <pre><code>const myVariable = stage.variables[\"`jEk@4|i[#Fk?(8x)AV.-my variable\"];\nreturn function* () {\n  while (true) {\n    runtime.ext_scratch3_motion._moveSteps((+myVariable.value || 0), target);\n    yield;\n  }\n};\n</code></pre> <p>Things to notice:</p> <ul> <li>No more looking up block IDs or opcodes: it's just JavaScript.</li> <li>No more looking up inputs manually: they're just JavaScript arguments.</li> <li>No more manual state maintaining: it's just JavaScript.</li> <li>As this is a single JavaScript function, we can't easily implement live script editing</li> <li>If the JavaScript JIT notices that a certain variable is always a number, it can theoretically optimize accordingly.</li> <li>This JavaScript looks very strange compared to typical human-written JavaScript and runs slower because we maintain compatibility with edge case Scratch behaviors.</li> <li>We manually formatted the JavaScript and renamed some variables to make it more readable. The real code uses variable names like <code>b0</code> and has no formatting.</li> </ul> <p>Of course, this is a very simple script where the interpreter overhead is negligible, which is the case for most projects. It's only when you execute thousands of blocks per frame that the interpreter's overhead becomes significant.</p> <p>Here's a more complex example: a sorting algorithm - bubble sort.</p> <pre><code>const length = stage.variables[\"O;aH~(njYNn}Bl@}!%pS-length-\"];\nconst list = stage.variables[\"O;aH~(njYNn}Bl@}!%pS-list-list\"];\nconst newLength = stage.variables[\"O;aH~(njYNn}Bl@}!%pS-new-\"];\nconst i = stage.variables[\"O;aH~(njYNn}Bl@}!%pS-i-\"];\nconst temp = stage.variables[\"O;aH~(njYNn}Bl@}!%pS-tmp-\"];\nreturn function fun1_sort () {\n  length.value = list.value.length;\n  // repeat until length = 0\n  while (!compareEqual(length.value, 0)) {\n    newLength.value = 0;\n    i.value = 1;\n    // repeat length - 1 times\n    for (var counter = ((+length.value || 0) - 1) || 0; counter &gt;= 0.5; counter--) {\n      // change i by 1\n      i.value = ((+i.value || 0) + 1);\n      // if item i - 1 of list is greater than item i of list\n      if (\n        compareGreaterThan(\n          list.value[((((i.value || 0) - 1) || 0) | 0) - 1] ?? \"\",\n          list.value[((i.value || 0) | 0) - 1] ?? \"\"\n        )\n      ) {\n        // swap item i and i - 1 of list\n        temp.value = listGet(list.value, i.value);\n        listReplace(\n          list,\n          i.value,\n          list.value[((((+i.value || 0) - 1) || 0) | 0) - 1] ?? \"\"\n        );\n        listReplace(\n          list,\n          (+i.value || 0) - 1,\n          temp.value\n        );\n        newLength.value = i.value;\n      }\n    }\n    length.value = newLength.value;\n  }\n};\n</code></pre> <p>Functions such as <code>listGet</code>, <code>listReplace</code>, and <code>compareEqual</code> are part of the TurboWarp runtime and are implemented to match the strange behaviors of Scratch. The functions used by bubble sort are shown below, for your reference. Accuracy and performance are a higher priority than readability for these functions as they tend to be quite hot.</p> <pre><code>const isNotActuallyZero = val =&gt; {\n  if (typeof val !== 'string') return false;\n  for (let i = 0; i &lt; val.length; i++) {\n    const code = val.charCodeAt(i);\n    if (code === 48 || code === 9) {\n      return false;\n    }\n  }\n  return true;\n};\n\nconst compareEqualSlow = (v1, v2) =&gt; {\n  const n1 = +v1;\n  if (isNaN(n1) || (n1 === 0 &amp;&amp; isNotActuallyZero(v1))) return ('' + v1).toLowerCase() === ('' + v2).toLowerCase();\n  const n2 = +v2;\n  if (isNaN(n2) || (n2 === 0 &amp;&amp; isNotActuallyZero(v2))) return ('' + v1).toLowerCase() === ('' + v2).toLowerCase();\n  return n1 === n2;\n};\n\nconst compareEqual = (v1, v2) =&gt; (typeof v1 === 'number' &amp;&amp; typeof v2 === 'number' &amp;&amp; !isNaN(v1) &amp;&amp; !isNaN(v2) || v1 === v2) ? v1 === v2 : compareEqualSlow(v1, v2);\n\nconst compareGreaterThanSlow = (v1, v2) =&gt; {\n  let n1 = +v1;\n  let n2 = +v2;\n  if (n1 === 0 &amp;&amp; isNotActuallyZero(v1)) {\n    n1 = NaN;\n  } else if (n2 === 0 &amp;&amp; isNotActuallyZero(v2)) {\n    n2 = NaN;\n  }\n  if (isNaN(n1) || isNaN(n2)) {\n    const s1 = ('' + v1).toLowerCase();\n    const s2 = ('' + v2).toLowerCase();\n    return s1 &gt; s2;\n  }\n  return n1 &gt; n2;\n};\n\nconst compareGreaterThan = (v1, v2) =&gt; typeof v1 === 'number' &amp;&amp; typeof v2 === 'number' &amp;&amp; !isNaN(v1) ? v1 &gt; v2 : compareGreaterThanSlow(v1, v2);\n\nconst listIndexSlow = (index, length) =&gt; {\n  if (index === 'last') {\n    return length - 1;\n  } else if (index === 'random' || index === 'any') {\n    if (length &gt; 0) {\n      return (Math.random() * length) | 0;\n    }\n    return -1;\n  }\n  index = (+index || 0) | 0;\n  if (index &lt; 1 || index &gt; length) {\n    return -1;\n  }\n  return index - 1;\n};\n\nconst listIndex = (index, length) =&gt; {\n  if (typeof index !== 'number') {\n    return listIndexSlow(index, length);\n  }\n  index = index | 0;\n  return index &lt; 1 || index &gt; length ? -1 : index - 1;\n};\n\nconst listGet = (list, idx) =&gt; {\n  const index = listIndex(idx, list.length);\n  if (index === -1) {\n    return '';\n  }\n  return list[index];\n};\n\nconst listReplace = (list, idx, value) =&gt; {\n  const index = listIndex(idx, list.value.length);\n  if (index === -1) {\n    return;\n  }\n  list.value[index] = value;\n  list._monitorUpToDate = false;\n};\n</code></pre>"},{"location":"website/how-it-works/#live-script-editing","title":"Live script editing","text":"<p>If you start a script using the compiler, you won't be able to move, remove, or add blocks and have the changes be reflected in real time as they would be in Scratch. The script has to be restarted for changes to apply. We believe there are some ways we could make this work, but they will hurt performance or add significant complexity. It's something we want to implement eventually, but not yet.</p>"},{"location":"website/javascript/","title":"How to download the JavaScript","text":""},{"location":"website/javascript/#short","title":"Short Answer","text":"<ul> <li>If you want to package/HTMLify a project, use https://packager.turbowarp.org/</li> <li>If you want to convert Scratch projects to readable and editable JavaScript, use https://leopardjs.com/ instead of TurboWarp</li> </ul>"},{"location":"website/javascript/#long","title":"Long Answer","text":"<p>The code generated by TurboWarp is not designed to be read or edited by humans. Attempting to do so would be actively harmful to one's learning because of the many unusual things done to improve compatibility or performance.</p> <p>For example, in regular JavaScript accessing a list item is as simple as <code>myList[myIndex]</code>, but TurboWarp could do anything from <code>(b1.value[(b0.value | 0) - 1] ?? \"\")</code> to <code>listGet(b0, b1.value)</code> depending on the context around the list block. <code>b0</code> and <code>b1</code> are real variable names that TurboWarp will use and <code>listGet</code> is a part of the TurboWarp runtime, not part of the JavaScript standard. The code also lacks any formatting. Some more code samples are available in another page.</p> <p>If you want to convert Scratch projects to readable and editable JavaScript, use https://leopardjs.com/</p> If you really know what you're doing...  Run this in the JavaScript console before starting the project:  <pre><code>vm.enableDebug();\n</code></pre>  Then the JavaScript will be logged to the console when it gets compiled.  If you don't know what a \"JavaScript console\" is or how to access it, then it's in your best interest to not look at the generated JavaScript anyways."},{"location":"website/new-compiler/","title":"New Compiler","text":"<p>The compiler is the part of TurboWarp that converts projects to JavaScript. On September 20, 2025, we released a new compiler that is better at analyzing the scripts inside projects to generate even faster JavaScript.</p> <p>This is the largest single change we've ever made. We've tried to test it thoroughly, but it's quite likely there are still a few more bugs. You should report broken projects at the usual place. If your project is broken, you can use https://experiments.turbowarp.org/old-compiler/ instead until we fix the bug in the new compiler.</p> <p>:::warning The new compiler breaks a small handful of custom extensions. See the extensions section below for details and workarounds. :::</p> <p>The new compiler is used on the website, the packager, and the desktop app (v1.15.0 and later).</p>"},{"location":"website/new-compiler/#performance","title":"Performance comparison","text":"<p>The performance gain varies a lot depending on the project. Some projects run twice as fast, while others are unchanged, but there should be no projects that run slower.</p> Test Old Compiler New Compiler Linux in Scratch Time until shell Lower is better 21 seconds 12 seconds Faster SHA-256 Hash Hashes per second Higher is better 2711 per second 3010 per second Quicksort Sort 200000 random items Lower is better 0.0515 seconds 0.0451 seconds <p>(Tested using Chromium 140, Arch Linux, i7 4790k, warp timer disabled)</p>"},{"location":"website/new-compiler/#limitations","title":"Limitations","text":""},{"location":"website/new-compiler/#warp-timer","title":"Warp timer","text":"<p>The warp timer forces blocks marked as \"run without screen refresh\" to briefly pause after running for 500 ms to prevent an infinite loop from causing you to lose unsaved work. This is why the warp timer is automatically enabled when you open the TurboWarp editor.</p> <p>Unfortunately, the warp timer breaks many of the assumptions that the new compiler uses to optimize projects, so do not expect major performance improvements while you are in the editor or otherwise have the warp timer enabled. They won't run slower than they did in the old compiler, though.</p>"},{"location":"website/new-compiler/#extensions","title":"Extension compatibility","text":"<p>All extensions included in the TurboWarp extension list will work the same, and a vast majority of custom extensions will also continue to work the same.</p> <p>A small handful of custom extensions use an API called <code>i_will_not_ask_for_help_when_these_break</code> to integrate more directly with the compiler. We gave this API that crazy name because we knew it was going to break at some point, and we didn't want a small handful of extensions to restrict us from being able to change the compiler's internals when needed. If your project requires these extensions, you can use https://experiments.turbowarp.org/old-compiler/ instead until extensions become compatible.</p> <p>If you also need to package your project, you can use https://packager-legacy.turbowarp.org/old-compiler/.</p>"},{"location":"website/new-compiler/#technical-overview","title":"Brief technical overview","text":"<p>The broad idea is that the compiler analyzes scripts to determine what kinds of values each variable may have at each point in the script. This allows it to remove unnecessary type conversions and generate more specialized code. The old compiler tried to do this too, but was unable to reason about loops or conditionals.</p> <p>Consider this script that sums integers from 1 to 100. Suppose that the block is marked as \"run without screen refresh\" and warp timer is disabled.</p> <p></p> <p>The old compiler generates:</p> <pre><code>sum.value = 0;\ni.value = 1;\nfor (var a0 = 100; a0 &gt;= 0.5; a0--) {\n    sum.value = ((+sum.value || 0) + (+i.value || 0));\n    i.value = ((+i.value || 0) + 1);\n}\n</code></pre> <p><code>(+something.value || 0)</code> is how the compiler converts a variable to a number. In this case it is redundant as the variables are already always numbers, but the old compiler did not realize this.</p> <p>The new compiler instead generates:</p> <pre><code>sum.value = 0;\ni.value = 1;\nfor (var a0 = 100; a0 &gt; 0; a0--) {\n    sum.value = (sum.value + i.value);\n    i.value = (i.value + 1);\n}\n</code></pre> <p>No more unnecessary type conversions. The compiler also now realizes that the iteration count is always an integer, so it doesn't need to handle the edge case of decimal iteration counts. Small changes like this can add up to be significant.</p> <p>If warp timer is enabled or the script is not marked as \"run without screen refresh\", the new compiler generates the same code as the old compiler. This is because the repeat block might pause before it finishes all iterations, so other scripts have the opportunity to change variables in unknown ways. For example, if another script changed the \"i\" variable to a string, <code>i.value + 1</code> would act like the \"join\" block instead of addition. The type conversion would be necessary to ensure the script always works correctly in this case.</p> <p>(We manually cleaned up the JavaScript for this page. The actual code has no formatting and does not have meaningful variable names.)</p>"},{"location":"website/new-compiler/#credits","title":"Credits","text":"<p>Tacodiva did almost all the work and persevered through an impossibly long review process.</p> <p>Early testers helped us find and fix many bugs before release:</p> <ul> <li>Krypto</li> <li>Vadik1</li> <li>SpinningCube</li> <li>GamingWithDominic</li> <li>Scratch_Fakemon</li> <li>LSPECTRONIZTAR</li> <li>Terminal</li> </ul>"},{"location":"website/return/","title":"Custom Reporters","text":"<p>TurboWarp now supports custom reporters which lets you use any custom block in your project as a reporter, like the addition block built into Scratch. This is a pretty standard feature in text-based programming languages, but it can be hard to understand initially.</p> <p>:::info Projects that use this feature cannot be uploaded to the Scratch website. :::</p> <p>Custom reporters technically don't let you do anything you couldn't do before -- they just make it much easier to read and write. For example, if your project needs to repeat text a lot, you might make a script like this:</p> <p></p> <p>This works, but it's pretty ugly, and will only get worse as you use the block more. Using the return block to create a custom reporter, this becomes much simpler:</p> <p></p>"},{"location":"website/return/#usage","title":"How to use","text":"<p>Open the extension library by clicking the button in the bottom left of the editor (same place where you find things like \"pen\"), then enable \"Custom Reporters\":</p> <p></p> <p>Then, create a custom block as you normally would. To make a custom reporter, just drag a \"return\" block into the script -- it'll be located at the bottom of the custom block list. You don't have to check any boxes or toggle anything.</p> <p>Once a return block is hit, it functions similarly to \"stop this script\".</p> <p>TurboWarp automatically reshapes blocks to what it guesses is the correct shape, but sometimes it guesses wrong. You can always change a block's shape by right clicking on it and then choosing \"Changed To Stacked Block\" or \"Change To Reporter\".</p> <p>Similarly, if all the return blocks in a custom block contain a boolean (true/false) value such as \"1 &gt; 2\", then the custom block will also be boolean-shaped. This is just a visual helper as any custom reporter can be dropped into any input.</p>"},{"location":"website/return/#recursion","title":"Recursion","text":"<p>Recursion is also supported. This can be especially hard to grasp, but basically, blocks can run themselves. If you can take a large problem and continuously break it down into smaller problems until you reach a known \"base case\", many algorithms can be written very elegantly.</p> <p>Using recursion, you can rewrite the repeat block to use no variables at all:</p> <p></p> <p>Just like custom reporters themselves, recursion doesn't let you do anything that wasn't technically possible already, but it can make it much easier to understand. (Anything written with loops can be rewritten with recursion. Anything written with recursion can be rewritten with loops. Sometimes one solution is easier than the other.)</p> <p>:::info When using the compiler, beware of stack overflow errors from too much recursion. Recursing more than a few thousand calls deep typically will throw errors. :::</p>"},{"location":"website/return/#interpreter-compiler","title":"Differences between compiler and interpreter","text":"<p>The interpreter supports infinite recursion whereas the compiler is limited by the JavaScript stack size, which is typically about a few thousand calls deep but varies between systems and browsers.</p> <p>:::info It is recommended to ensure that custom reporters only run some algorithm and output a final answer. To ensure your project runs the same in the compiler and interpreter, custom reporters should avoid things like moving sprites, saying text, waiting, etc. :::</p> <p>To improve performance, the compiler has a feature known as short circuiting. Imagine a Scratch block like \"&lt; (1 = 2) and (3 = 3) &gt;\". When the compiler sees this block, it first evaluates \"1 = 2\", which is clearly false. In this case, the compiler doesn't even need to check the other side of the \"and\" block as it won't matter: the final result will always be false. Typically this is just free performance, but if your blocks have side effects such as moving sprites, different behaviors will occur as the interpreter always evaluates all blocks. Try this script to see:</p> <p></p> <p>If you have several custom reporters nested deeply inside other blocks, the order they run in can differ between the compiler and interpreter.</p>"},{"location":"website/scratch-accounts/","title":"Scratch Accounts &amp; TurboWarp","text":"<p>While you can't sign in to your Scratch account on TurboWarp (any website other than scratch.mit.edu that asks you for your Scratch password is a SCAM -- no exceptions), you can still run projects without sharing them, upload projects to Scratch, and use your own username.</p> <p>To run a project made in Scratch using TurboWarp without sharing it: Use File &gt; Save to your computer in the Scratch editor to save the project to a file on your computer, and select that file using File &gt; Load from your computer in TurboWarp.</p> <p>To upload a project made in TurboWarp to Scratch: Use File &gt; Save to your computer in TurboWarp's editor to save the project to a file on your computer, and select that file using File &gt; Load from your computer in Scratch's editor.</p> <p>To change your username in TurboWarp: Use Edit &gt; Change Username.</p> <p>Even if you're signed in to Scratch in another tab, TurboWarp can't access it because browsers prevent websites from being able to access login credentials of other websites (This is what keeps online banking safe). We would have to ask you for your Scratch password which would add unfixable security horrors and probably get us blocked by Scratch.</p> <p>Depending on what you're trying to do, you might find success using the TurboWarp Packager to be able to upload your project to generic HTML or game hosting sites.</p>"},{"location":"website/translate/","title":"Help Translate TurboWarp","text":"<p>We're looking for people to help translate TurboWarp into languages other than English. If that interests you, read on.</p>"},{"location":"website/translate/#requirements","title":"Requirements to join as a translator","text":"<ul> <li>You must be FLUENT IN THE ENGLISH LANGUAGE.</li> <li>For example, you\u2019re fluent if you can use TurboWarp in English, or if you understand griffpatch\u2019s videos. If you struggle to understand sentences without a translator, you\u2019re not fluent.</li> <li>You must be a NATIVE SPEAKER of the language you want to translate to.</li> <li>You must have an email address, which you should ideally check at least once a week.</li> <li>You must own an account on scratch.mit.edu.</li> </ul> <p>If you\u2019re not a native speaker but consider yourself fluent enough, you may also request to join. Keep in mind taking some language classes does not make you fluent. If you wouldn\u2019t change your smartphone\u2019s system language to it, you\u2019re not fluent enough!</p> <p>We only support languages that Scratch itself supports. Support for RTL languages such as Arabic and Hebrew is currently a work-in-progress. They should mostly work in the editor, but places like the desktop app and packager require additional changes. Efforts to improve this will be prioritized when some more translations are written.</p>"},{"location":"website/translate/#request-to-join","title":"Steps to join as a translator","text":""},{"location":"website/translate/#1-verify-your-scratch-account","title":"1. Verify your Scratch account","text":"<ol> <li>Visit this Scratch studio with your Scratch account.</li> <li>Send a studio comment indicating the language you want to translate to (for example, <code>Greek</code>). </li> </ol> <p>If you don\u2019t own a Scratch account, please send an email to contact@turbowarp.org instead.</p>"},{"location":"website/translate/#2-create-a-transifex-account","title":"2. Create a Transifex account","text":"<ol> <li>Go to Transifex open-source Sign up.  </li> <li>You will be shown Transifex's \"Sign up\" screen. DO NOT sign up with Google. </li> <li>In the \"business email\" field, enter your email (it can be Gmail, Outlook, or any other).</li> <li>In the \"username\" field, we highly recommend you enter your Scratch username, or a slight variation of it. For example, if your Scratch username is <code>john_walker954</code>, your Transifex username can be exactly the same (<code>john_walker954</code>) or <code>john_walker954_scratch</code>.</li> <li>In the \"password\" field, enter a password.</li> <li>Click the \"Sign up\" button.</li> <li>You'll be asked for your First name and Last name. - In the First name, we recommend you enter your Scratch username. - In the Last name, we recommend you enter the language you want to translate to (for example, <code>Greek</code>).</li> <li>In the \"languages you speak\" field, select at least one language you're fluent with (for example, English).</li> <li>Click the \"Let's get started\" button.</li> <li>Continue with the \"requesting a language\" steps below.</li> </ol> <p>If you already own a Transifex account and don\u2019t want to create a new one, please send an email to translation@turbowarp.org indicating your Transifex account\u2019s username. Then, continue with the \"requesting a language\" section below.</p>"},{"location":"website/translate/#3-requesting-a-language","title":"3. Requesting a language","text":"<ol> <li>Make sure you\u2019re logged in to Transifex. If you just signed up, you are already logged in.</li> <li>Go to TurboWarp's Transifex page.</li> <li>You\u2019ll be prompted to choose the language you want to translate to.</li> <li>Choose one of the languages which are \"available to join\". We do not support languages that are not available to join. </li> <li>Click the \"Join Project\" button.</li> <li>Wait until your request is accepted.</li> </ol> <p>:::tip If your request is accepted, you\u2019ll receive an email from Transifex. We usually review requests every 48 hours. :::</p> <p>:::warning If your request is denied, you\u2019ll receive an email. If you believe this was a mistake, please send an email to contact@turbowarp.org indicating your Transifex username. See below for other contact methods.  :::</p>"},{"location":"website/translate/#help-or-contact","title":"Help or contact","text":"<p>If you have any questions about translating, you may choose one of the following options:</p> <ul> <li>Send an email to contact@turbowarp.org.</li> <li>Open a discussion on GitHub (GitHub account required).</li> </ul>"},{"location":"website/turbowarp-blocks/","title":"TurboWarp Blocks","text":"<p>TurboWarp has a section of blocks that allows you to use certain features previously not accessible to Scratch projects.</p> <p>NEW: TurboWarp now supports unsandboxed extensions which add new blocks! https://extensions.turbowarp.org/</p>"},{"location":"website/turbowarp-blocks/#is-compiled","title":"is compiled? and is TurboWarp?","text":"<p>See https://scratch.mit.edu/projects/414716080/</p> <p>These blocks are \"compatible\" with Scratch because they're actually just modified argument reporters.</p> <p>:::warning Every block beyond this warning is incompatible with Scratch. Projects that use them cannot be uploaded to the Scratch website. If you don't use any TurboWarp exclusive blocks, then there should be no issue with making your project in TurboWarp and uploading it to Scratch. :::</p>"},{"location":"website/turbowarp-blocks/#last-key-pressed","title":"last key pressed","text":"<p>It tells you the last key that was pressed. It's intended to be used something like this:</p> <p></p>"},{"location":"website/turbowarp-blocks/#mouse-button-down","title":"mouse button down?","text":"<p>It's like \"mouse down?\" but lets you check each individual button. Keep in mind that due to how Scratch interprets mouse input, it's possible for a block like \"is primary mouse button down?\" to report true while the standard \"mouse down?\" reports false.</p> <ul> <li>(0) primary is usually left click</li> <li>(1) middle is usually scroll wheel</li> <li>(2) secondary is usually right click (running this block once will disable right click on the stage)</li> </ul>"},{"location":"website/unshared-projects/","title":"Unshared projects are no longer visible","text":"<p>Unshared projects can no longer be opened on TurboWarp, forkphorus, and other third-party sites due to changes to the Scratch API.</p> <p>This page answers most of the questions people have and lists some workarounds. Please read it in full before discussing these changes with other people to avoid misinformation.</p> <p>:::warning ANY website other than scratch.mit.edu that asks for your Scratch password is a SCAM, even if it supposedly lets you share your unshared projects with other users. You WILL have your account stolen and projects deleted. There are NO EXCEPTIONS to this rule. :::</p>"},{"location":"website/unshared-projects/#what-happened","title":"What happened","text":"<p>We want to be clear: These changes were made by the Scratch Team. TurboWarp is a third-party website that is not affiliated with the Scratch Team; we did not make these changes.</p> <p>Downloading a project from the Scratch API now requires a \"project token\" that, for unshared projects, can only be accessed by the owner of the project. Even if you're signed in to your Scratch account in the same browser, TurboWarp can't access it. These tokens are temporary and expire after a few minutes, so the owner can't just provide a token once to keep it visible forever.</p> <p>Unshared projects were always something that just happened to work and weren't the intended main use of TurboWarp. Things like the compiler and addons have always been the focus and will continue to work for shared projects, projects loaded from files, and the desktop app.</p>"},{"location":"website/unshared-projects/#workarounds","title":"Workarounds","text":"<p>For testing your own projects: You can use the File &gt; Save to your computer and File &gt; Load from your computer menus in the Scratch editor to load your unshared Scratch projects in TurboWarp or upload projects made in TurboWarp to Scratch. Alternatively, many people have had success working on their projects primarily in TurboWarp either using the website or desktop app and uploading their projects to Scratch when they're complete (please remember to make routine backups when doing this).</p> <p>For collaborations: The best way to share a project with other people is to simply share it on the Scratch website. The Scratch community is really nice. This is what Scratch wants you to do. It's okay to share unfinished projects. Scratch is 15 years old while TurboWarp is two years old. Collaborations happened just fine during the 13 years without TurboWarp and will continue just fine.</p> <p>For embedding in other websites: To embed unshared projects in other websites, either Share the project on Scratch or download the project to your computer with the File &gt; Save to your computer menu in the Scratch editor, and use the TurboWarp Packager to convert this project to a standalone file that can be embedded.</p>"},{"location":"website/unshared-projects/#good-thing","title":"This is a good thing","text":"<p>Securing unshared projects is a decade overdue.</p> <p>Don't pretend that no one has had their project stolen because they didn't know unshared projects aren't actually private even though the Scratch website says \"only you can see it\". Many unshared projects include pictures and videos of children, their friends, their family, and other personal information under the assumption that unshared projects are actually private.</p> <p>In most other large websites, \"unshared\" or \"private\" things being effectively public would be considered a critical security bug and usually be eligible for a large bug bounty. For example, YouTube paid a security researcher $5000 for reporting a bug that allowed them to view low-resolution images from any private video.</p> <p>We've always had the stance that if people want unshared projects to actually be private, they should talk to the Scratch Team. Perhaps enough people did that for the Scratch Team to listen.</p>"},{"location":"website/unshared-projects/#developers","title":"For developers","text":"<p>This section is for people developing third-party Scratch-related tools.</p> <p>The new procedure to download projects is to first fetch \"project_token\" field from <code>https://api.scratch.mit.edu/projects/ID</code> then use that to generate the URL <code>https://projects.scratch.mit.edu/ID?token=TOKEN</code></p> <p>If you're using JavaScript, here's some sample code to get you started that will work in web browsers. If your code is running server-side (eg. Node.js), you should replace <code>https://trampoline.turbowarp.org/api/projects/</code> with <code>https://api.scratch.mit.edu/projects/</code> as servers are immune to CORS. We make no guarantees about the uptime of trampoline.turbowarp.org; use at your own risk. You may also be interested in sb-downloader (includes easy API) for a complete full project downloader.</p> <pre><code>const getProjectMetadata = async (projectId) =&gt; {\n    // IF IN A WEB BROWSER, you need to use a service like trampoline.turbowarp.org to access the Scratch API.\n    // IF IN NODE.JS, you should use https://api.scratch.mit.edu/projects/${projectId} directly instead.\n    const response = await fetch(`https://trampoline.turbowarp.org/api/projects/${projectId}`);\n    if (response.status === 404) {\n        throw new Error('The project is unshared or does not exist');\n    }\n    if (!response.ok) {\n        throw new Error(`HTTP error ${response.status} fetching project metadata`);\n    }\n    const json = await response.json();\n    return json;\n};\n\nconst getProjectData = async (projectId) =&gt; {\n    const metadata = await getProjectMetadata(projectId);\n    const token = metadata.project_token;\n    const response = await fetch(`https://projects.scratch.mit.edu/${projectId}?token=${token}`);\n    if (!response.ok) {\n        throw new Error(`HTTP error ${response.status} fetching project data`);\n    }\n    const data = await response.arrayBuffer();\n    return data;\n};\n\ngetProjectData('60917032').then((data) =&gt; {\n    console.log(data);\n}).catch((error) =&gt; {\n    console.error(error);\n});\n</code></pre> <p>We release this code segment under the Unlicense.</p>"},{"location":"website/url-parameters/","title":"URL Parameters","text":"<p>:::note</p>"},{"location":"website/url-parameters/#only-hidden-url-parameters-are-listed-here","title":"Only \"hidden\" URL parameters are listed here","text":"<p>TurboWarp will automatically store settings such as turbo mode, 60 FPS, high quality pen, etc. in the URL, but some advanced options still need to be manually applied. This page only documents these advanced options. :::</p>"},{"location":"website/url-parameters/#username","title":"Username","text":"<p>The <code>username</code> option controls the value of the username block.</p> <p>https://turbowarp.org/443603478?username=ExampleUsername</p>"},{"location":"website/url-parameters/#cloud_host","title":"Cloud host","text":"<p>The <code>cloud_host</code> option lets you change the cloud variable server that TurboWarp will connect to, for example:</p> <p>https://turbowarp.org/12785898?cloud_host=wss://clouddata.turbowarp.org</p> <p>Inclusion of <code>ws://</code> or <code>wss://</code> is optional but recommended. <code>wss://clouddata.turbowarp.org</code> is the default cloud data server used by TurboWarp, so this example doesn't actually change anything. Insecure ws:// servers may not work because TurboWarp uses HTTPS.</p> <p>It is not possible to use this to connect to Scratch's cloud variable server as it requires account credentials which TurboWarp can't support.</p>"},{"location":"website/url-parameters/#extension","title":"Custom extensions","text":"<p>The <code>extension</code> option loads a custom extension from a URL. See Custom Extensions.</p>"},{"location":"website/url-parameters/#nocompile","title":"Disable compiler","text":"<p>The <code>nocompile</code> option turns off the compiler. You probably shouldn't enable this.</p> <p>https://turbowarp.org/?nocompile</p>"},{"location":"website/url-parameters/#project_url","title":"Project URL","text":"<p>The <code>project_url</code> option tells TurboWarp to download project data from an arbitrary URL. Do not use together with a regular project ID.</p> <p>https://turbowarp.org/?project_url=packager.turbowarp.org/example.sb3</p> <p>https:// is implied if you don't include a protocol. http:// URLs generally will not work for security reasons. Note that the URL needs to be a direct download and must support CORS (<code>Access-Control-Allow-Origin: *</code>). GitHub Pages will do this automatically and is known to work well.</p>"},{"location":"website/settings/custom-fps/","title":"60 FPS (Custom FPS)","text":"<p>A custom FPS (frames per second) changes how often scripts are run every second. Most often this is changed to 60 FPS, but any value between 1 and 250 is possible.</p> <p>A value of 0 will make the project run at the same framerate as the screen instead of a set interval. This also means that the project's scripts may stop running when the project's tab is hidden.</p> <p>A vast majority of projects will not work properly with custom framerates. For these projects, interpolation should be used instead. For example, consider the following simple script:</p> <p></p> <p>When running at 30 FPS (as Scratch typically does), this script will run 30 times per second, so the sprite will move 30 steps per second. However, if the framerate is changed to 60, the script will run 60 times per second, so the sprite will move twice as many steps in a second.</p> <p>To make projects that are compatible with custom framerates, you should use techniques such as delta time:</p> <ul> <li>https://en.wikipedia.org/wiki/Delta_timing</li> <li>https://scratch.mit.edu/projects/487694716/ (Scratch example)</li> </ul> <p>Please note that using these techniques may require significant changes to your project.</p>"},{"location":"website/settings/custom-stage-size/","title":"Custom Stage Size","text":"<p>Changes the size of the Scratch stage from 480x360 (4:3) to something else.</p> <p>:::caution Most projects will not work properly with custom stage size. :::</p> <p>640x360 will make a widescreen 16:9 stage. Using higher resolutions such as 1280x720, 1920x1080, or larger is technically possible, but we recommend using a lower resolution with the same aspect ratio and allowing fullscreen mode to upscale it to the user's display (remember that some displays might not even fit such large stages!).</p> <p>Projects can detect the stage size using methods such as https://scratch.mit.edu/projects/588493413/</p>"},{"location":"website/settings/disable-compiler/","title":"Disable Compiler","text":"<p>This option turns off the TurboWarp compiler, which lets script update immediately, as in Scratch. This is only useful when debugging bugs in the compiler or when using the editor to create a project.</p> <p>:::warning Never change this unless you really know what you're doing. :::</p> <p>You can enable the \"Disable compiler in editor\" addon to turn the compiler off by default in the editor.</p>"},{"location":"website/settings/high-quality-pen/","title":"High Quality Pen","text":"<p>High Quality Pen allows pen projects to render at a higher resolution rather than being stuck at 480x360 and disables some coordinate rounding in the editor.</p> <p>:::caution High quality pen can significantly reduce performance, especially when in fullscreen mode, as there are just so many more pixels that have to be drawn.</p> <p>Not all projects will look better with high quality pen enabled. :::</p> High Quality Pen Off High Quality Pen On <p>Project pictured: https://scratch.mit.edu/projects/437594584/ with seed 803258.</p>"},{"location":"website/settings/infinite-clones/","title":"Infinite Clones","text":"<p>Infinite Clones disables Scratch's 300 clone limit.</p> <p>:::caution Some projects assume that Scratch will prevent it from creating more clones at some point. These projects may break with this option enabled. :::</p>"},{"location":"website/settings/interpolation/","title":"Interpolation","text":"<p>Interpolation makes motion animations in projects appear smoother by interpolating movement of sprites between frames. It's basically higher framerate without affecting how fast scripts run.</p> <p>Interpolation should not be used on:</p> <ul> <li>3D projects</li> <li>Raytracers</li> <li>Pen projects</li> <li>Laggy projects</li> </ul> <p>Interpolation is unlikely to make these projects look smoother because interpolation can't interpolate pen, but it will hurt performance.</p> <p>Interpolation can introduce slight (up to 1/30th of a second) input latency.</p> <p>You may see some graphical glitches on complex projects such as scrolling platformers.</p>"},{"location":"website/settings/overview/","title":"Advanced Settings","text":"<p>Advanced settings allow you to reconfigure your project to do things that Scratch normally wouldn't let you do.</p> <p>Navigate using the sidebar on the left. Look under the \"Advanced settings\" category.</p> <p>import BrowserOnly from \"@docusaurus/BrowserOnly\"; import {Redirect} from \"@docusaurus/router\";</p> <p>{() =&gt; {   if (location.hash === \"#high-quality-pen\") {     return ;   }   return &lt;&gt;; }}</p>"},{"location":"website/settings/remove-fencing/","title":"Remove Fencing","text":"<p>Allows sprites to move offscreen, become as large or as small as they want, and allows touching blocks to work offscreen.</p> <p>This may slightly improve performance in some projects.</p> <p>:::caution This may break some projects. :::</p>"},{"location":"website/settings/remove-misc-limits/","title":"Remove Miscellaneous Limits","text":"<p>Disables various limits that aren't significant enough to get a dedicated toggle.</p> <ul> <li>Pitch sound effect range is increased from 360 to 1000</li> <li>Blocks that set or change sound effects or volume run instantly instead of stopping the script for a full frame</li> <li>Minimum pen size is reduced from 1 to 0 and maximum pen is increased from 1200 to infinite</li> <li>Mouse X and Y coordinates will not be rounded, which can be useful in fullscreen</li> <li>Removes 30 concurrent drum/note limit from the music extension</li> </ul> <p>This list will be expanded over time.</p>"},{"location":"website/settings/warp-timer/","title":"Warp Timer","text":"<p>Warp Timer makes scripts check if they are stuck in a long or infinite loop and run at a low framerate instead of getting stuck until the loop finishes. This fixes most crashes but has a significant performance impact, so it's only enabled by default in the editor.</p> <p>As a demonstration, consider the project https://turbowarp.org/446742201?stuck. This project has an infinite loop inside a run without screen refresh block. With Warp Timer enabled, the project will run at around two frames per second. With Warp Timer disabled, however, the script will never end.</p> <p>Warp Timer was previously called \"Stuck Checking\".</p>"}]}